<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>计算机基础 - 编码方案转换的原理</title>
      <link href="/2021/11/03/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80-%E7%BC%96%E7%A0%81%E6%96%B9%E6%A1%88%E8%BD%AC%E6%8D%A2%E7%9A%84%E5%8E%9F%E7%90%86/"/>
      <url>/2021/11/03/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80-%E7%BC%96%E7%A0%81%E6%96%B9%E6%A1%88%E8%BD%AC%E6%8D%A2%E7%9A%84%E5%8E%9F%E7%90%86/</url>
      
        <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><pre><code>在将某个字符从一种编码方案转换成另一种编码方案时，我们不必单独维护从源编码方案到目标编码方案的转换数组，只需要先将源编码方案转换成一种中间编码方案，再将中间编码方案转换成目标编码方案。这样对于任何一种编码方案来说，仅需维护它与中间编码方案的转换数组即可。这个中间编码方案指的就是Unicode！</code></pre><h2 id="图例"><a href="#图例" class="headerlink" title="图例"></a>图例</h2><p><img src="/2021/11/03/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80-%E7%BC%96%E7%A0%81%E6%96%B9%E6%A1%88%E8%BD%AC%E6%8D%A2%E7%9A%84%E5%8E%9F%E7%90%86/trans.jpg" alt="图"> </p><h2 id="php-的转换方案"><a href="#php-的转换方案" class="headerlink" title="php 的转换方案"></a>php 的转换方案</h2><blockquote><p>基于：mbstring 模块 </p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$str</span> = <span class="string">&#x27;陶喆&#x27;</span>;</span><br><span class="line"><span class="keyword">echo</span> mb_detect_encoding(<span class="variable">$str</span>); <span class="comment">// UTF-8</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$str</span> = <span class="string">&#x27;áéóú&#x27;</span>;</span><br><span class="line"><span class="keyword">echo</span> mb_detect_encoding(<span class="variable">$str</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> 计算机基础 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>网络 - 动画演示</title>
      <link href="/2021/11/02/%E7%BD%91%E7%BB%9C-%E5%8A%A8%E7%94%BB%E6%BC%94%E7%A4%BA/"/>
      <url>/2021/11/02/%E7%BD%91%E7%BB%9C-%E5%8A%A8%E7%94%BB%E6%BC%94%E7%A4%BA/</url>
      
        <content type="html"><![CDATA[<h3 id="tcp-发包-流程演示"><a href="#tcp-发包-流程演示" class="headerlink" title="tcp 发包 流程演示"></a>tcp 发包 流程演示</h3><p><a href="https://www2.tkn.tu-berlin.de/teaching/rn/animations/flow/">Flow Control</a><br><a href="https://www2.tkn.tu-berlin.de/teaching/rn/animations/queue/">Queuing and Loss</a><br><a href="https://www2.tkn.tu-berlin.de/teaching/rn/animations/gbn_sr/">Selective Repeat / Go Back N</a></p><blockquote><p>引用<br><a href="https://mp.weixin.qq.com/s/WG1Is0HMAHYMgRvJQpd3KA">直接吹爆，这个网站！</a></p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> Network </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PHP - Composer 更新依赖库</title>
      <link href="/2021/10/28/PHP-Composer-%E6%9B%B4%E6%96%B0%E4%BE%9D%E8%B5%96%E5%BA%93/"/>
      <url>/2021/10/28/PHP-Composer-%E6%9B%B4%E6%96%B0%E4%BE%9D%E8%B5%96%E5%BA%93/</url>
      
        <content type="html"><![CDATA[<h3 id="方案"><a href="#方案" class="headerlink" title="方案"></a>方案</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># package-name格式： foo/bar or foo/bar:1.0.0 or foo/bar=1.0.0 or &quot;foo/bar 1.0.0&quot;</span></span><br><span class="line">composer require package-name</span><br></pre></td></tr></table></figure><h3 id="查看命令手册"><a href="#查看命令手册" class="headerlink" title="查看命令手册"></a>查看命令手册</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">composer require -h</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> PHP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>随记 - 本地https快速解决方案</title>
      <link href="/2021/10/25/%E9%9A%8F%E8%AE%B0-%E6%9C%AC%E5%9C%B0https%E5%BF%AB%E9%80%9F%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/"/>
      <url>/2021/10/25/%E9%9A%8F%E8%AE%B0-%E6%9C%AC%E5%9C%B0https%E5%BF%AB%E9%80%9F%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/</url>
      
        <content type="html"><![CDATA[<h3 id="环境准备"><a href="#环境准备" class="headerlink" title="环境准备"></a>环境准备</h3><ol><li>服务器： 192.168.20.214</li></ol><h3 id="步骤"><a href="#步骤" class="headerlink" title="步骤"></a>步骤</h3><ol><li>安装程序<blockquote><p>参考 -&gt; linux 下的安装 mkcert</p></blockquote></li><li>为服务端生成 CA 证书<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkcert domain1</span><br></pre></td></tr></table></figure></li><li>使用生成的证书<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># nginx 为例子</span></span><br><span class="line"><span class="section">server</span> &#123;</span><br><span class="line"><span class="comment"># 服务器端口使用443，开启ssl, 这里ssl就是上面安装的ssl模块</span></span><br><span class="line">    <span class="attribute">listen</span>       <span class="number">443</span> ssl;</span><br><span class="line"><span class="comment"># 域名，多个以空格分开</span></span><br><span class="line">    <span class="attribute">server_name</span>  demo2.kit;</span><br><span class="line"></span><br><span class="line"><span class="comment"># ssl证书地址</span></span><br><span class="line">    <span class="attribute">ssl_certificate</span>     /home/work/cert/demo2.kit.pem;  <span class="comment"># pem文件的路径</span></span><br><span class="line"><span class="attribute">ssl_certificate_key</span>  /home/work/cert/demo2.kit-key.pem; <span class="comment"># key文件的路径</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ssl验证相关配置</span></span><br><span class="line"><span class="attribute">ssl_session_timeout</span>  <span class="number">5m</span>;    <span class="comment">#缓存有效期</span></span><br><span class="line"><span class="attribute">ssl_ciphers</span> ECDHE-RSA-AES128-GCM-SHA256:ECDHE:ECDH:AES:HIGH:!NULL:!aNULL:!MD5:!ADH:!RC4;    <span class="comment">#加密算法</span></span><br><span class="line"><span class="attribute">ssl_protocols</span> TLSv1 TLSv1.<span class="number">1</span> TLSv1.<span class="number">2</span>;    <span class="comment">#安全链接可选的加密协议</span></span><br><span class="line"><span class="attribute">ssl_prefer_server_ciphers</span> <span class="literal">on</span>;   <span class="comment">#使用服务器端的首选算法</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">location</span> / &#123;</span><br><span class="line">    <span class="attribute">root</span>   /work/web/kit/;</span><br><span class="line">    <span class="attribute">index</span>  index.html index.htm;</span><br><span class="line">&#125;</span><br><span class="line">    <span class="attribute">access_log</span>  /work/logs/nginx/kit.com.access.log;</span><br><span class="line">    <span class="attribute">error_log</span>  /work/logs/nginx/kit.com.<span class="literal">error</span>.log;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li>下载客户端 ca 证书<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cp /home/work/cert/demo2.kit.pem /home/work/cert/demo2.kit.crt</span><br><span class="line">sz /home/work/cert/demo2.kit.crt</span><br></pre></td></tr></table></figure></li><li>为客户端安装证书<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">window: 双击  &gt; 一路下一步 &gt; 完成</span><br><span class="line">mac: 双击 &gt; 设置 `始终信任`</span><br></pre></td></tr></table></figure></li></ol><h3 id="引用"><a href="#引用" class="headerlink" title="引用"></a>引用</h3><ul><li><a href="https://blog.dteam.top/posts/2019-04/%E6%9C%AC%E5%9C%B0https%E5%BF%AB%E9%80%9F%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88mkcert.html">本地https快速解决方案——mkcert</a></li><li><a href="https://mazq.cn/linux/2020/07/17/%E5%B1%80%E5%9F%9F%E7%BD%91%E5%86%85%E5%BF%AB%E9%80%9F%E9%A2%81%E5%8F%91%E8%87%AA%E7%AD%BE%E5%90%8D%E8%AF%81%E4%B9%A6-%E4%BD%BF%E7%94%A8mkcert/">linux 下的安装 mkcert</a></li></ul>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>PHP - CIDR 的php实现</title>
      <link href="/2021/10/21/PHP-CIDR-%E7%9A%84php%E5%AE%9E%E7%8E%B0/"/>
      <url>/2021/10/21/PHP-CIDR-%E7%9A%84php%E5%AE%9E%E7%8E%B0/</url>
      
        <content type="html"><![CDATA[<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 计算 CIDR 对应区间的 ip</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * 因业务需求，将排除如下ip：</span></span><br><span class="line"><span class="comment"> *   网络 172.16.26.0 =&gt; 保留</span></span><br><span class="line"><span class="comment"> *   第一可用 172.16.26.1 =&gt; VPN服务器</span></span><br><span class="line"><span class="comment"> *   最后可用 172.16.27.254 =&gt; 保留</span></span><br><span class="line"><span class="comment"> *   广播 172.16.27.255 =&gt; 保留</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">getAllHostIPAddresses</span>(<span class="params"><span class="variable">$cidr</span> = <span class="string">&#x27;172.16.26.0/23&#x27;</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$cidr</span> = explode(<span class="string">&#x27;/&#x27;</span>, <span class="variable">$cidr</span>);</span><br><span class="line">    <span class="comment">// 去掉网络号 + vpn服务器占用</span></span><br><span class="line">    <span class="variable">$startIp</span> = ip2long(<span class="variable">$cidr</span>[<span class="number">0</span>]) + <span class="number">2</span>;</span><br><span class="line">    <span class="comment">// 去掉广播 + 最后可用 + 初始加上的2</span></span><br><span class="line">    <span class="variable">$endIp</span> = <span class="variable">$startIp</span> + pow(<span class="number">2</span>, <span class="number">32</span>-(<span class="keyword">int</span>)(<span class="variable">$cidr</span>[<span class="number">1</span>])) - <span class="number">2</span> - <span class="number">2</span>;</span><br><span class="line">    <span class="variable">$count</span> = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$ip</span> = <span class="variable">$startIp</span>; <span class="variable">$ip</span> &lt; <span class="variable">$endIp</span>; <span class="variable">$ip</span>++) &#123;</span><br><span class="line">        <span class="comment">// yield long2ip($begin);</span></span><br><span class="line">        print_r(long2ip(<span class="variable">$ip</span>) . <span class="string">&quot;\n&quot;</span>);</span><br><span class="line">        <span class="variable">$count</span>++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 减掉最后加上的1</span></span><br><span class="line">    <span class="variable">$ip</span>--;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;count: <span class="subst">&#123;$count&#125;</span>; startIp: <span class="subst">&#123;$startIp&#125;</span> - &quot;</span>.long2ip(<span class="variable">$startIp</span>).<span class="string">&quot;; endIp: <span class="subst">&#123;$ip&#125;</span> - &quot;</span>. long2ip(<span class="variable">$ip</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>引用<br><a href="https://www.php.net/manual/zh/function.ip2long.php">ip2long</a><br><a href="https://gist.github.com/stibiumz/5e6a92a195c50c875649">CIDR.php</a><br><a href="https://github.com/markrogoyski/ipv4-subnet-calculator-php">ipv4-subnet-calculator-php</a><br><a href="https://github.com/S1lentium/IPTools">IPTools</a></p></blockquote>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>随记 - 网页视频下载方案</title>
      <link href="/2021/10/18/%E9%9A%8F%E8%AE%B0-%E7%BD%91%E9%A1%B5%E8%A7%86%E9%A2%91%E4%B8%8B%E8%BD%BD%E6%96%B9%E6%A1%88/"/>
      <url>/2021/10/18/%E9%9A%8F%E8%AE%B0-%E7%BD%91%E9%A1%B5%E8%A7%86%E9%A2%91%E4%B8%8B%E8%BD%BD%E6%96%B9%E6%A1%88/</url>
      
        <content type="html"><![CDATA[<h2 id="获取-m3u8-格式的文件"><a href="#获取-m3u8-格式的文件" class="headerlink" title="获取 m3u8 格式的文件"></a>获取 m3u8 格式的文件</h2><ul><li>使用 <code>mac</code> 下的 <code>downie</code> 下载</li></ul><h2 id="直接审查，获取视频下载地址"><a href="#直接审查，获取视频下载地址" class="headerlink" title="直接审查，获取视频下载地址"></a>直接审查，获取视频下载地址</h2><ul><li>使用 迅雷下载</li></ul><h2 id="阿里云下载"><a href="#阿里云下载" class="headerlink" title="阿里云下载"></a>阿里云下载</h2><blockquote><p>资源搜索：<a href="http://alixiaozhan.com/">http://alixiaozhan.com/</a><br>阿里云客户端下载</p></blockquote>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>GO - mod replace 简单使用</title>
      <link href="/2021/09/07/GO-mod-replace-%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8/"/>
      <url>/2021/09/07/GO-mod-replace-%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<h3 id="需求分析"><a href="#需求分析" class="headerlink" title="需求分析"></a>需求分析</h3><pre><code>想直接修改远程包的代码，或者本地还没发布到线上，直接用本地的包时，可以这么玩</code></pre><h3 id="流程"><a href="#流程" class="headerlink" title="流程"></a>流程</h3><ol><li>mkdir ~/your-project-path</li><li>cd ~/your-project-path &amp;&amp; go mod init huid-gotour</li><li>vim main.go<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;github.com/mitchellh/go-ps&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    ps, _ := ps.Processes()</span><br><span class="line">log.Println(ps[<span class="number">0</span>].Executable())</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> pp := <span class="keyword">range</span> ps &#123;</span><br><span class="line">log.Printf(<span class="string">&quot;%d %s\n&quot;</span>, ps[pp].Pid(), ps[pp].Executable())</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li>假设想改包内源码,为了本地可以快速测试，可按如下操作<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. mkdir src/vendor/huid/go-ps, 将 github.com/mitchellh/go-ps 代码复制进去</span></span><br><span class="line"><span class="comment"># 2. 修改 根目录下的 go.mod文件</span></span><br><span class="line">require github.com/shirou/gopsutil/v3 v3.21.8</span><br><span class="line">replace github.com/mitchellh/go-ps =&gt; /your-path/huid/go-ps</span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li>执行命令<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">go mod vendor</span><br><span class="line">go run xxx</span><br></pre></td></tr></table></figure></li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> GO </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PHP - 多版本管理 - phpbrew</title>
      <link href="/2021/08/29/PHP-%E5%A4%9A%E7%89%88%E6%9C%AC%E7%AE%A1%E7%90%86-phpbrew/"/>
      <url>/2021/08/29/PHP-%E5%A4%9A%E7%89%88%E6%9C%AC%E7%AE%A1%E7%90%86-phpbrew/</url>
      
        <content type="html"><![CDATA[<h3 id="简单入门"><a href="#简单入门" class="headerlink" title="简单入门"></a>简单入门</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"># 查看已安装的 php 版本,其中 * 号代表当前使用的</span><br><span class="line">1. phpbrew list  // * php-8.0.10 </span><br><span class="line">                 //   php-7.4.2</span><br><span class="line"></span><br><span class="line"># 查看 远程可安装的 php 版本，如下列表</span><br><span class="line">2. phpbrew known</span><br><span class="line">// 8.0: 8.0.10, 8.0.9, 8.0.8, 8.0.7, 8.0.6, 8.0.5, 8.0.3, 8.0.2 ...</span><br><span class="line">// 7.4: 7.4.23, 7.4.22, 7.4.21, 7.4.20, 7.4.19, 7.4.18, 7.4.16, 7.4.15 ...</span><br><span class="line">// 7.3: 7.3.30, 7.3.29, 7.3.28, 7.3.27, 7.3.26, 7.3.25, 7.3.24, 7.3.23 ...</span><br><span class="line">// 7.2: 7.2.34, 7.2.33, 7.2.32, 7.2.31, 7.2.30, 7.2.29, 7.2.28, 7.2.27 ...</span><br><span class="line">// 7.1: 7.1.33, 7.1.32, 7.1.31, 7.1.30, 7.1.29, 7.1.28, 7.1.27, 7.1.26 ...</span><br><span class="line">// 7.0: 7.0.33, 7.0.32, 7.0.31, 7.0.30 ...</span><br><span class="line"></span><br><span class="line"># 基于 2 获取到具体的版本号后，直接安装</span><br><span class="line"># 假设是 8.0.10</span><br><span class="line">3. phpbrew install 8.0.10</span><br><span class="line"></span><br><span class="line"># 运行查看当前版本</span><br><span class="line">4. php --version // PHP 8.0.10</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="基础用法"><a href="#基础用法" class="headerlink" title="基础用法"></a>基础用法</h3><table><thead><tr><th>命令</th><th>描述</th></tr></thead><tbody><tr><td>phpbrew known</td><td>列出已知 PHP 版本</td></tr><tr><td>phpbrew use php-7.4.2</td><td>切换版本</td></tr></tbody></table><h3 id="扩展安装"><a href="#扩展安装" class="headerlink" title="扩展安装"></a>扩展安装</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装 zlib  </span></span><br><span class="line">phpbrew ext install zlib</span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装 xdebug </span></span><br><span class="line">phpbrew ext install xdebug stable</span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装 iconv, 带自定义的 iconv 安装路径 </span></span><br><span class="line">phpbrew ext install iconv --with-iconv=/usr/<span class="built_in">local</span>/opt/libiconv</span><br></pre></td></tr></table></figure><p><a href="https://github.com/phpbrew/phpbrew/blob/master/README.cn.md">see more</a></p><h3 id="tips"><a href="#tips" class="headerlink" title="tips"></a>tips</h3><h4 id="安装失败"><a href="#安装失败" class="headerlink" title="安装失败"></a>安装失败</h4><h5 id="问题："><a href="#问题：" class="headerlink" title="问题："></a>问题：</h5><p>tar: Error opening archive: Unrecognized archive format</p><h5 id="解决方案："><a href="#解决方案：" class="headerlink" title="解决方案："></a>解决方案：</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">curl -L https://www.php.net/get/php-7.2.16.tar.bz2/from/this/mirror -o ~/.phpbrew/distfiles/php-7.2.16.tar.bz2</span><br><span class="line"></span><br></pre></td></tr></table></figure><h5 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h5><p>提前将源码文件下载到 指定的 <code>distfiles</code> 下，再执行 <code>phpbrew install php-7.2.16</code> 时，会直接从 <code>distfiles</code> 目录下查找</p>]]></content>
      
      
      
        <tags>
            
            <tag> PHP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PHP - 锁相关</title>
      <link href="/2021/08/29/PHP-%E9%94%81%E7%9B%B8%E5%85%B3/"/>
      <url>/2021/08/29/PHP-%E9%94%81%E7%9B%B8%E5%85%B3/</url>
      
        <content type="html"><![CDATA[<h2 id="起因"><a href="#起因" class="headerlink" title="起因"></a>起因</h2><pre><code>想控制当 N 个请求时，到 PHP 端只会运行一次</code></pre><h2 id="踩坑"><a href="#踩坑" class="headerlink" title="踩坑"></a>踩坑</h2><h3 id="正确的代码【1】-use-file-exist"><a href="#正确的代码【1】-use-file-exist" class="headerlink" title="正确的代码【1】 - [use file exist]"></a>正确的代码【1】 - [use file exist]</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$path</span> = <span class="string">&#x27;./lock.txt&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (file_exists(<span class="variable">$path</span>)) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="number">1</span> . PHP_EOL;</span><br><span class="line">    <span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">touch(<span class="variable">$path</span>);</span><br><span class="line"><span class="comment">// echo &#x27;running&#x27; . PHP_EOL;</span></span><br><span class="line">sleep(<span class="number">10</span>);</span><br><span class="line"></span><br><span class="line">unlink(<span class="variable">$path</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;done&#x27;</span>;</span><br></pre></td></tr></table></figure><h3 id="正确的代码【2】-use-file-flock"><a href="#正确的代码【2】-use-file-flock" class="headerlink" title="正确的代码【2】 - [use file flock]"></a>正确的代码【2】 - [use file flock]</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$handle</span> = fopen(<span class="string">&#x27;./lock.txt&#x27;</span>, <span class="string">&#x27;w+&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$res</span> = flock(<span class="variable">$handle</span>, LOCK_EX | LOCK_NB, <span class="variable">$block</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$res</span>) &#123;</span><br><span class="line">    sleep(<span class="number">10</span>);</span><br><span class="line">    <span class="comment">// echo fread($handle, filesize(&#x27;./1.txt&#x27;));</span></span><br><span class="line">    <span class="comment">// sleep(3);</span></span><br><span class="line">    flock(<span class="variable">$handle</span>, LOCK_UN);</span><br><span class="line">    fclose(<span class="variable">$handle</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;done&#x27;</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;文件已锁定&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="正确的代码【3】-use-redis-lock"><a href="#正确的代码【3】-use-redis-lock" class="headerlink" title="正确的代码【3】 - [use redis lock]"></a>正确的代码【3】 - [use redis lock]</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$token</span> = mt_rand(<span class="number">1</span>, <span class="number">10000000</span>);</span><br><span class="line"><span class="variable">$redis</span> = <span class="keyword">new</span> \Redis();</span><br><span class="line"><span class="variable">$redis</span>-&gt;connect(<span class="string">&#x27;192.168.20.214&#x27;</span>, <span class="number">6379</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">lock</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">global</span> <span class="variable">$redis</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$redis</span>-&gt;set(<span class="string">&#x27;my:lock&#x27;</span>, <span class="number">1</span>, [<span class="string">&#x27;nx&#x27;</span>, <span class="string">&#x27;ex&#x27;</span> =&gt; <span class="number">10</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">unlock</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="variable">$script</span> = &lt;&lt;&lt;<span class="string">&#x27;LUA&#x27;</span></span><br><span class="line"><span class="keyword">if</span> redis.call(<span class="string">&quot;get&quot;</span>,KEYS[<span class="number">1</span>]) == ARGV[<span class="number">1</span>] then</span><br><span class="line">    <span class="keyword">return</span> redis.call(<span class="string">&quot;del&quot;</span>,KEYS[<span class="number">1</span>])</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">end</span><br><span class="line">LUA;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">global</span> <span class="variable">$redis</span>;</span><br><span class="line">    <span class="keyword">global</span> <span class="variable">$token</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$redis</span>-&gt;eval(<span class="variable">$script</span>, [<span class="string">&#x27;my:lock&#x27;</span>, <span class="variable">$token</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (lock()) &#123;</span><br><span class="line">    sleep(<span class="number">10</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;done&#x27;</span>;</span><br><span class="line">    unlock();</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;文件已锁定&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="正确的-php-fpm-个数"><a href="#正确的-php-fpm-个数" class="headerlink" title="正确的 php-fpm 个数"></a>正确的 php-fpm 个数</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">phpbrew fpm start <span class="comment">// mean php-fpm 大于 1</span></span><br></pre></td></tr></table></figure><h3 id="1-错误的测试方式1"><a href="#1-错误的测试方式1" class="headerlink" title="1. 错误的测试方式1"></a>1. 错误的测试方式1</h3><h4 id="测试方法"><a href="#测试方法" class="headerlink" title="测试方法"></a>测试方法</h4><ul><li>同一客户端 (浏览器) 发起 N 个请求</li></ul><h4 id="结果"><a href="#结果" class="headerlink" title="结果"></a>结果</h4><p>当对同一个 URL 发出多个请求时，即使是跨选项卡或窗口发出请求，浏览器也足够“聪明”，可以等待第一个请求完成，然后浏览器尝试运行后续请求</p><blockquote><p><a href="https://stackoverflow.com/questions/24440731/php-flock-not-locking/30820654">引用</a></p></blockquote><h4 id="改进"><a href="#改进" class="headerlink" title="改进"></a>改进</h4><ul><li>方法一：使用 <code>curl</code> 请求，可以正确返回</li><li>方法二：使用不同浏览器访问，可以正确返回</li></ul><h3 id="2-错误的测试方式2"><a href="#2-错误的测试方式2" class="headerlink" title="2. 错误的测试方式2"></a>2. 错误的测试方式2</h3><h4 id="测试方法-1"><a href="#测试方法-1" class="headerlink" title="测试方法"></a>测试方法</h4><ul><li>使用 php -S localhost:8000</li><li>如上方式，只有单一进程，即，处理也是顺序执行</li></ul><h4 id="结果-1"><a href="#结果-1" class="headerlink" title="结果"></a>结果</h4><p>当对同一个 URL 发出多个请求时，依旧是排队处理</p><h4 id="改进-1"><a href="#改进-1" class="headerlink" title="改进"></a>改进</h4><ul><li>换成 php-fpm</li></ul><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><h3 id="正常访问-amp-并发访问（1000-请求；100-并发）"><a href="#正常访问-amp-并发访问（1000-请求；100-并发）" class="headerlink" title="正常访问 &amp; 并发访问（1000 请求；100 并发）"></a>正常访问 &amp; 并发访问（1000 请求；100 并发）</h3><p>代码1，在 客户端 执行期间被中断时，将无法再次运行，代码2 跟 代码3 可以（存在失效时间）</p>]]></content>
      
      
      
        <tags>
            
            <tag> PHP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hexo 关于 markdown 文件 语法解析异常报错备忘</title>
      <link href="/2021/08/12/Hexo-%E5%85%B3%E4%BA%8E-markdown-%E6%96%87%E4%BB%B6-%E8%AF%AD%E6%B3%95%E8%A7%A3%E6%9E%90%E5%BC%82%E5%B8%B8%E6%8A%A5%E9%94%99%E5%A4%87%E5%BF%98/"/>
      <url>/2021/08/12/Hexo-%E5%85%B3%E4%BA%8E-markdown-%E6%96%87%E4%BB%B6-%E8%AF%AD%E6%B3%95%E8%A7%A3%E6%9E%90%E5%BC%82%E5%B8%B8%E6%8A%A5%E9%94%99%E5%A4%87%E5%BF%98/</url>
      
        <content type="html"><![CDATA[<h3 id="如果在-markdown-内容这么写："><a href="#如果在-markdown-内容这么写：" class="headerlink" title="如果在 markdown 内容这么写："></a>如果在 markdown 内容这么写：</h3><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="quote">&gt; 引用</span></span><br><span class="line"></span><br><span class="line"><span class="bullet">1.</span> [<span class="string">如何开启nginx服务的rewrite_log</span>](<span class="link">http://www.yuzhewo.com/2015/11/01/%E5%A6%82%E4%BD%95%E5%BC%80%E5%90%AFnginx%E6%9C%8D%E5%8A%A1%E7%9A%84rewrite-log/</span>)</span><br><span class="line"><span class="bullet">2.</span> [<span class="string">深入理解Nginx的rewrite模块</span>](<span class="link">https://www.cnblogs.com/sunsky303/p/12718378.html</span>)</span><br><span class="line"><span class="bullet">3.</span> [<span class="string">在开发环境下使用nginx重写uri及代理功能</span>](<span class="link">https://juejin.cn/post/6844903847295451149#heading-1</span>)![](http://)</span><br></pre></td></tr></table></figure><h3 id="报错"><a href="#报错" class="headerlink" title="报错:"></a>报错:</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">err: TypeError [ERR_INVALID_URL]: Invalid URL: http://</span><br></pre></td></tr></table></figure><h3 id="修复"><a href="#修复" class="headerlink" title="修复"></a>修复</h3><p>将 markdown 内容修复即可，即如上第3点的链接写法不合法的地方改正</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Python - ModuleNotFoundError: No module named 小记</title>
      <link href="/2021/08/12/Python-ModuleNotFoundError-No-module-named-%E5%B0%8F%E8%AE%B0/"/>
      <url>/2021/08/12/Python-ModuleNotFoundError-No-module-named-%E5%B0%8F%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<h2 id="演示-demo"><a href="#演示-demo" class="headerlink" title="演示 demo"></a>演示 demo</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">├── a.py</span><br><span class="line">└── bb</span><br><span class="line">    ├── __pycache__</span><br><span class="line">    │   ├── __init__.cpython-39.pyc</span><br><span class="line">    │   └── b.cpython-39.pyc</span><br><span class="line">    └── b.py</span><br></pre></td></tr></table></figure><h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><h3 id="a-py"><a href="#a-py" class="headerlink" title="a.py"></a>a.py</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python</span><br><span class="line"># -*- coding: UTF-8 -*-</span><br><span class="line"></span><br><span class="line"># from bb.b import echo_b</span><br><span class="line"></span><br><span class="line">def echo_a():</span><br><span class="line">    print(&#x27;hello; from aaa&#x27;)</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    echo_a()</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="b-py"><a href="#b-py" class="headerlink" title="b.py"></a>b.py</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python</span><br><span class="line"># -*- coding: UTF-8 -*-</span><br><span class="line"></span><br><span class="line">from a import echo_a</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def echo_b():</span><br><span class="line">    print(&#x27;hello; from bb&#x27;)</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    echo_a()</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h2><h3 id="问题描述"><a href="#问题描述" class="headerlink" title="问题描述"></a>问题描述</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 调用</span></span><br><span class="line">python bb/b.py</span><br><span class="line"></span><br><span class="line"><span class="comment"># 异常</span></span><br><span class="line"><span class="comment"># ModuleNotFoundError: No module named &#x27;a&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> PYTHONPATH=your path</span><br></pre></td></tr></table></figure><h3 id="解释-amp-说明"><a href="#解释-amp-说明" class="headerlink" title="解释 &amp; 说明"></a>解释 &amp; 说明</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出 python执行器所查找的文件目录</span></span><br><span class="line"><span class="built_in">print</span>(sys.path)</span><br><span class="line"></span><br><span class="line"><span class="comment"># PYTHONPATH 设定 这个环境变量的值，可以让 sys.path 新增一个路径</span></span><br><span class="line"><span class="comment"># 类似</span></span><br><span class="line">sys.path.insert(<span class="number">1</span>, <span class="string">&#x27;your path&#x27;</span>)</span><br><span class="line"><span class="comment"># or</span></span><br><span class="line">sys.path.append(<span class="string">&#x27;your path&#x27;</span>)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>服务端-常见问题 小记</title>
      <link href="/2021/07/25/%E6%9C%8D%E5%8A%A1%E7%AB%AF-%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98-%E5%B0%8F%E8%AE%B0/"/>
      <url>/2021/07/25/%E6%9C%8D%E5%8A%A1%E7%AB%AF-%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98-%E5%B0%8F%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<h3 id="nginx-引起"><a href="#nginx-引起" class="headerlink" title="nginx 引起"></a>nginx 引起</h3><h4 id="fastcgi-read-timeout"><a href="#fastcgi-read-timeout" class="headerlink" title="fastcgi_read_timeout"></a>fastcgi_read_timeout</h4><ol><li><p>配置项</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 指定nginx接受后端fastcgi响应请求超时时间</span></span><br><span class="line">fastcgi_read_timeout 8;</span><br></pre></td></tr></table></figure></li><li><p>超时 nginx 日志</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">upstream timed out (110: Connection timed out) while reading upstream,</span><br></pre></td></tr></table></figure></li><li><p>状态码</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">504</span><br></pre></td></tr></table></figure></li></ol><h3 id="php-引起"><a href="#php-引起" class="headerlink" title="php 引起"></a>php 引起</h3><h4 id="request-terminate-timeout"><a href="#request-terminate-timeout" class="headerlink" title="request_terminate_timeout"></a>request_terminate_timeout</h4><ol><li><p>配置项</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># php-fpm 接受的请求的超时时间，超过这个时间 php-fpm 会 kill 掉执行脚本的 worker 进程。</span></span><br><span class="line">request_terminate_timeout</span><br></pre></td></tr></table></figure></li><li><p>超时 nginx 日志</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">recv() failed (104: Connection reset by peer) while reading response header from upstream</span><br></pre></td></tr></table></figure></li><li><p>超时 php-fpm 日志</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[23-Jul-2021 15:34:17] WARNING: [pool www] child 24287, script &#x27;/work/web/file.superdalan.com/www/index.php&#x27; (request: &quot;GET /index.php?s=/1916601d95a1e75f0b43ed00855dc669&quot;) execution timed out (30.992374 sec), terminating</span><br><span class="line">[23-Jul-2021 15:34:17] WARNING: [pool www] child 24287 exited on signal 15 (SIGTERM) after 5340.190998 seconds from start</span><br><span class="line">[23-Jul-2021 15:34:17] NOTICE: [pool www] child 12424 started</span><br></pre></td></tr></table></figure></li><li><p>状态码</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">502</span><br></pre></td></tr></table></figure></li></ol><blockquote><p>引用<br><a href="http://wulfric.me/2018/07/nginx-demo/">nginx 502 和 504 超时演示</a></p></blockquote>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>GIT-rebase 小记</title>
      <link href="/2021/07/21/GIT-rebase-%E5%B0%8F%E8%AE%B0/"/>
      <url>/2021/07/21/GIT-rebase-%E5%B0%8F%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<h3 id="合并多个-commit-为一个"><a href="#合并多个-commit-为一个" class="headerlink" title="合并多个 commit 为一个"></a>合并多个 commit 为一个</h3><h4 id="1-查看历史记录"><a href="#1-查看历史记录" class="headerlink" title="1. 查看历史记录"></a>1. 查看历史记录</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">log</span> --oneline</span><br><span class="line"></span><br><span class="line"><span class="comment"># 选择需要合并的分支</span></span><br><span class="line"><span class="comment">#c6d445a (HEAD -&gt; master) third commit</span></span><br><span class="line"><span class="comment">#c133f69 second commit</span></span><br><span class="line"><span class="comment">#593a606 first commit</span></span><br></pre></td></tr></table></figure><h4 id="2-将-second-跟-third-合并"><a href="#2-将-second-跟-third-合并" class="headerlink" title="2. 将 second 跟 third 合并"></a>2. 将 second 跟 third 合并</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git rebase -i 593a606</span><br></pre></td></tr></table></figure><blockquote><p>-i 的参数是不需要合并的 commit 的 hash 值，这里指的是第一条 commit</p></blockquote><h4 id="3-选择合适的操作"><a href="#3-选择合适的操作" class="headerlink" title="3. 选择合适的操作"></a>3. 选择合适的操作</h4><blockquote><p>pick：保留该commit（缩写:p）<br>reword：保留该commit，但我需要修改该commit的注释（缩写:r）<br>edit：保留该commit, 但我要停下来修改该提交(不仅仅修改注释)（缩写:e）<br>squash：将该commit和前一个commit合并（缩写:s）<br>fixup：将该commit和前一个commit合并，但我不要保留该提交的注释信息（缩写:f）<br>exec：执行shell命令（缩写:x）<br>drop：丢弃该commit（缩写:d）</p></blockquote><p>如上，应该选择</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1 pick c133f69 second commit</span><br><span class="line">2 s c6d445a third commit # 将 pick 改为 s</span><br></pre></td></tr></table></figure><p>:wq 后，编辑一下 commit message</p><h4 id="4-最后的最后，来个强推"><a href="#4-最后的最后，来个强推" class="headerlink" title="4. 最后的最后，来个强推"></a>4. 最后的最后，来个强推</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git push --force-with-leas 你的远程分支</span><br></pre></td></tr></table></figure><blockquote><p>补充一个sourcetree 的使用方式文档<br><a href="https://www.huaweicloud.com/articles/63ed78162899759873f867de6940f5a6.html">git的GUI工具Sourcetree使用及命令行对比</a></p></blockquote><blockquote><p>引用<br><a href="https://www.jianshu.com/p/964de879904a">「Git」合并多个 Commit</a><br><a href="https://www.jianshu.com/p/4a8f4af4e803">【Git】rebase 用法小结</a><br><a href="https://blog.walterlv.com/post/safe-push-using-force-with-lease.html">Git 更安全的强制推送，–force-with-lease</a></p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> GIT </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PHP-字符串下标形式访问小记</title>
      <link href="/2021/07/14/PHP-%E5%AD%97%E7%AC%A6%E4%B8%B2%E4%B8%8B%E6%A0%87%E5%BD%A2%E5%BC%8F%E8%AE%BF%E9%97%AE%E5%B0%8F%E8%AE%B0/"/>
      <url>/2021/07/14/PHP-%E5%AD%97%E7%AC%A6%E4%B8%B2%E4%B8%8B%E6%A0%87%E5%BD%A2%E5%BC%8F%E8%AE%BF%E9%97%AE%E5%B0%8F%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// waring ==&gt; 修改失败</span></span><br><span class="line"><span class="comment">// PHP Warning:  Cannot use a scalar value as an array in /Users/huid/web/learns/php-learn/error.php on line 12</span></span><br><span class="line"><span class="variable">$out</span> = <span class="number">4238</span>;</span><br><span class="line"><span class="comment">// waring ==&gt; 修改成功</span></span><br><span class="line"><span class="comment">// PHP Warning:  Illegal string offset &#x27;aaa&#x27; in /Users/huid/web/learns/php-learn/error.php on line 9</span></span><br><span class="line"><span class="variable">$out</span> = <span class="string">&#x27;4238&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$out</span>[<span class="string">&#x27;aaa&#x27;</span>] = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$out</span>;</span><br></pre></td></tr></table></figure><h3 id="结论"><a href="#结论" class="headerlink" title="结论"></a>结论</h3><blockquote><p>1的情况，会修改成功，输出 1238<br>2的情况，会修改成功，输出 1238</p></blockquote><h3 id="尝试理解"><a href="#尝试理解" class="headerlink" title="尝试理解"></a>尝试理解</h3><h4 id="问题1：为啥是-1238"><a href="#问题1：为啥是-1238" class="headerlink" title="问题1：为啥是 1238?"></a>问题1：为啥是 1238?</h4><blockquote><p>答：$out[] 这种模式下，代表 会以数组的形式访问 $out（字符串赋值时），$out[‘aaa’] 会变成 $out[0] 去访问下标为 0 的 $out 字符串<br>类比：’aa’ == 0 这种情况； 可将 $out[‘aaa’] 换成 $out[3] 试一下效果</p></blockquote><h4 id="问题2-为啥-整型-会失败？"><a href="#问题2-为啥-整型-会失败？" class="headerlink" title="问题2: 为啥 整型 会失败？"></a>问题2: 为啥 整型 会失败？</h4><blockquote><p>答：整型不能以数组下标的形式访问</p></blockquote>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Awesome Video</title>
      <link href="/2021/06/22/Awesome%20Video/"/>
      <url>/2021/06/22/Awesome%20Video/</url>
      
        <content type="html"><![CDATA[<p><strong>说明</strong></p><blockquote><p>免得想看视频时，没得看，先收集一波先。</p></blockquote><p><strong>目录</strong></p><ul><li><a href="#%E5%8A%A8%E6%BC%AB">动漫</a><ul><li><a href="#%E5%9C%A8%E7%BA%BF">在线</a></li><li><a href="#%E8%B5%84%E8%AE%AF--%E4%B8%8B%E8%BD%BD">资讯 &amp; 下载</a></li></ul></li><li><a href="#%E5%BD%B1%E8%A7%86">影视</a><ul><li><a href="#%E5%BD%B1%E8%A7%86%E5%A4%A7%E5%85%A8">影视大全</a></li><li><a href="#%E5%BD%B1%E8%A7%86%E4%B8%8B%E8%BD%BD">影视下载</a></li><li><a href="#%E7%94%B5%E8%A7%86%E5%89%A7">电视剧</a><ul><li><a href="#%E7%BE%8E%E5%89%A7">美剧</a></li><li><a href="#%E9%9F%A9%E5%89%A7">韩剧</a></li></ul></li><li><a href="#vip-%E8%A7%86%E9%A2%91">vip 视频</a></li></ul></li><li><a href="#%E6%BC%AB%E7%94%BB">漫画</a></li></ul><h2 id="动漫"><a href="#动漫" class="headerlink" title="动漫"></a>动漫</h2><h3 id="在线"><a href="#在线" class="headerlink" title="在线"></a>在线</h3><p><em>顾名思义，就是在线可看的</em></p><ul><li><a href="https://zzzfun.com/">zzzfun</a> - 有一周的更新表，剧场版，很高清</li><li><a href="https://agefans.org/">AGE 动漫</a> - AGE 动漫，资源多，备用站点多<ul><li><a href="https://agefans.org/">AGE org</a></li><li><a href="https://www.agefans.net/">AGE net</a></li></ul></li><li><a href="https://www.xskdm.com/">新时空动漫</a></li><li><a href="http://www.futa404.com/comic1">动漫在线 – 扶她404</a></li></ul><h3 id="资讯-amp-下载"><a href="#资讯-amp-下载" class="headerlink" title="资讯 &amp; 下载"></a>资讯 &amp; 下载</h3><ul><li><a href="https://acg.rip/">ACG.RIP</a></li><li><a href="https://mikanani.me/">蜜柑计划 - Mikan Project</a></li><li><a href="https://www.acgmh.com/">ACG门户 – 给你最新鲜的动漫资讯</a></li><li><a href="https://bangumi.moe/">番組、萌え</a></li><li><a href="https://bgmlist.com/">番组放送</a></li><li><a href="http://www.kisssub.org/">爱恋动漫BT下载</a></li><li><a href="https://bt.acgzero.com/?catId=331">零度动漫下载站</a></li><li><a href="https://www.s5t.com/">搜网通</a></li></ul><h2 id="影视"><a href="#影视" class="headerlink" title="影视"></a>影视</h2><h3 id="影视大全"><a href="#影视大全" class="headerlink" title="影视大全"></a>影视大全</h3><ul><li><a href="https://www.dianyinggou.com/">电影狗 - 专业电影搜索引擎</a></li><li><a href="https://yyets.dmesg.app/resource.html?id=27807">YYeTs分享站</a> - 人人影视资源分享</li><li><a href="https://www.qwspcz.com/">村长看啥片-愿世界和平</a></li><li><a href="https://bwl87.com/">阿房影视-免费·在线·全集·蓝光影视·实时更新日韩·欧美·动漫·国产电视剧·超前点播</a></li><li><a href="http://dianying.in/">电影先生 - 聚合全网高清影视在线观看、下载</a></li><li><a href="https://www.pianba.net/">片吧-最新手机电影-电视剧排行榜-片吧影院</a></li><li><a href="https://www.555dy1.com/">555电影-免费电影-在线电影网-入殓师-秘密访客-风林火山-我的姐姐-第十一回-555影视-4月份-2021最新电影-六人-泰坦尼克上的中国幸存者</a></li><li><a href="https://nfxhd.com/?btwaf=73929542">奈飞星高清</a></li><li><a href="https://www.novipnoad.com/tv/western/114857.html">【美剧】权力的游戏 第六季 (10集全)【衣柜字幕组】_高清在线观看 – NO视频</a></li><li><a href="http://lackk.com/douban/">豆瓣电影本周口碑榜 - 在线观看</a></li><li><a href="https://www.bttwo.com/">两个BT – BT下载与分享</a></li><li><a href="https://www.mvcat.com/">电影推荐 · MVCAT</a></li><li><a href="https://www.novipnoad.com/">NO视频 – 不负追剧好时光 (￣▽￣)”</a></li><li><a href="https://www.idybee.com/">电影蜜蜂-高清电影资源最新电影下载</a></li><li><a href="https://www.bde4.cc/">哔嘀影视，热门电影，最新电影，最新电视剧，免费下载，免费在线观看</a></li><li><a href="http://ifkdy.com/">疯狂影视搜索-电影搜索一站拥有无尽影视资源</a></li><li><a href="https://www.xinshipai.vip/vodtype/1.html">电影 - 新视觉影院_6080新视觉影院_YY6080新视觉影院</a></li><li><a href="https://z1.m1907.cn/">m1907</a></li><li><a href="https://www.duboku.tv/">独播库</a></li><li><a href="https://www.pianku.tv/">片库 - 全网高清影视聚合下载</a></li><li><a href="https://www.aixiaoju.com/">爱笑聚 - 最新影视剧分享平台</a></li><li><a href="https://xinghe.tv/">主页 | 星河影院 – 需翻墙</a></li><li><a href="https://aidi.tv/v/dongman.html">爱迪影视</a></li><li><a href="https://www.ak1080.com/">闪电影视</a></li><li><a href="https://www.zxzj.me/">在线之家</a></li></ul><h3 id="影视下载"><a href="#影视下载" class="headerlink" title="影视下载"></a>影视下载</h3><ul><li><a href="https://www.6vgood.com/">6v电影网，最新电影，最新电视剧，免费电影下载，电视剧下载，迅雷下载</a></li><li><a href="https://www.xl720.com/">迅雷电影天堂</a></li><li><a href="https://yyets.dmesg.app/resource?id=11022">人人影视</a></li><li><a href="https://www.dytt89.com/">电影天堂</a></li></ul><h3 id="电视剧"><a href="#电视剧" class="headerlink" title="电视剧"></a>电视剧</h3><h4 id="美剧"><a href="#美剧" class="headerlink" title="美剧"></a>美剧</h4><ul><li><a href="https://91mjw.com/">91美剧网</a></li><li><a href="https://www.meiju11.com/Play/3542-1-19.html">爱美剧</a></li><li><a href="https://www.meijumi.net/">美剧迷</a></li></ul><h4 id="韩剧"><a href="#韩剧" class="headerlink" title="韩剧"></a>韩剧</h4><ul><li><a href="https://www.juji.tv/">韩剧网-韩剧TV,最新韩剧,韩国电视剧,剧集网</a></li></ul><h3 id="vip-视频"><a href="#vip-视频" class="headerlink" title="vip 视频"></a>vip 视频</h3><ul><li><a href="https://vip.bljiex.com/">BL解析-Vip视频在线解析</a></li></ul><h2 id="漫画"><a href="#漫画" class="headerlink" title="漫画"></a>漫画</h2><ul><li><a href="http://www.dmhy.org/topics/list">首頁 - 動漫花園資源網 - 動漫愛好者的自由交流平台</a></li><li><a href="https://www.dongmanhuayuan.com/">动漫花园资源网 - 动漫爱好者的自由交流平台</a></li><li><a href="http://www.comicat.org/">漫猫动漫BT下载</a></li><li><a href="http://www.kisssub.org/">爱恋动漫BT下载</a></li><li><a href="https://www.soman.com/">搜漫_一站式漫画搜索引擎</a></li><li><a href="http://99.hhxxee.com/">火影忍者漫畫 漫畫 海賊王漫畫 在線漫畫 火影忍者584 , www.99comic.com 九九漫畫</a></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> Awesome </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Awesome study</title>
      <link href="/2021/06/22/Awesome%20study/"/>
      <url>/2021/06/22/Awesome%20study/</url>
      
        <content type="html"><![CDATA[<h2 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h2><ul><li><a href="#%E7%9B%AE%E5%BD%95">目录</a><ul><li><a href="#react">react</a></li><li><a href="#php">php</a></li><li><a href="#go">go</a></li><li><a href="#c">c</a></li><li><a href="#javascript">javascript</a></li></ul></li></ul><h3 id="react"><a href="#react" class="headerlink" title="react"></a>react</h3><ul><li><a href="https://react.iamkasong.com/">React技术揭秘</a></li><li><a href="https://hyf.js.org/react-naive-book/">React.js 小书</a></li></ul><h3 id="php"><a href="#php" class="headerlink" title="php"></a>php</h3><h3 id="go"><a href="#go" class="headerlink" title="go"></a>go</h3><ul><li><a href="https://learnku.com/docs/the-way-to-go">《Go 入门指南》 | Go 技术论坛</a></li><li><a href="https://learnku.com/docs/gobyexample/2020">《Go 编程实例 Go by Example》 | Go 技术论坛</a></li><li><a href="https://learnku.com/docs/effective-go/2020">《高效的 Go 编程 Effective Go》 | Go 技术论坛</a></li></ul><h3 id="c"><a href="#c" class="headerlink" title="c"></a>c</h3><ul><li><a href="https://justcc.mengkang.net/#/02/02-gcc">JustCC - Linux C 开发入门指导小册</a></li></ul><h3 id="javascript"><a href="#javascript" class="headerlink" title="javascript"></a>javascript</h3><ul><li><a href="https://zhuanlan.zhihu.com/p/267488164">[翻译] 瞧一瞧现代游览器如何工作？Part 1 - 知乎</a></li><li><a href="https://zhuanlan.zhihu.com/p/267730159">[翻译] 瞧一瞧现代游览器如何工作？Part 2 - 知乎</a></li><li><a href="https://zhuanlan.zhihu.com/p/267763621">[翻译] 瞧一瞧现代游览器如何工作？Part 3 - 知乎</a></li><li><a href="https://zhuanlan.zhihu.com/p/267819104">[翻译] 瞧一瞧现代游览器如何工作？Part 4 - 知乎</a></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> Awesome </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>查看端口使用情况</title>
      <link href="/2021/01/27/%E6%9F%A5%E7%9C%8B%E7%AB%AF%E5%8F%A3%E4%BD%BF%E7%94%A8%E6%83%85%E5%86%B5/"/>
      <url>/2021/01/27/%E6%9F%A5%E7%9C%8B%E7%AB%AF%E5%8F%A3%E4%BD%BF%E7%94%A8%E6%83%85%E5%86%B5/</url>
      
        <content type="html"><![CDATA[<h2 id="查看某一端口占用情况"><a href="#查看某一端口占用情况" class="headerlink" title="查看某一端口占用情况"></a>查看某一端口占用情况</h2><h3 id="第一种方法：使用-netstat"><a href="#第一种方法：使用-netstat" class="headerlink" title="第一种方法：使用 netstat"></a>第一种方法：使用 netstat</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo netstat -ltpn | grep :22</span><br></pre></td></tr></table></figure><h3 id="第二种方法：使用-lsof"><a href="#第二种方法：使用-lsof" class="headerlink" title="第二种方法：使用 lsof"></a>第二种方法：使用 lsof</h3><pre><code>因为在 linux 上一切皆文件，TCP socket 连接也是一个 fd。因此使用 lsof 也可以</code></pre><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo lsof -n -P -i:22</span><br><span class="line"></span><br><span class="line"><span class="comment">#-n 表示不将 IP 转换为 hostname，</span></span><br><span class="line"><span class="comment">#-P 表示不将 port number 转换为 service name</span></span><br><span class="line"><span class="comment">#-i:port 表示端口号为 22 的进程</span></span><br></pre></td></tr></table></figure><h2 id="如何查看进程监听的端口号"><a href="#如何查看进程监听的端口号" class="headerlink" title="如何查看进程监听的端口号"></a>如何查看进程监听的端口号</h2><h3 id="第一种方法：使用-netstat-1"><a href="#第一种方法：使用-netstat-1" class="headerlink" title="第一种方法：使用 netstat"></a>第一种方法：使用 netstat</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo netstat -atpn | grep 1333</span><br></pre></td></tr></table></figure><h3 id="第二种方法：使用-lsof-1"><a href="#第二种方法：使用-lsof-1" class="headerlink" title="第二种方法：使用 lsof"></a>第二种方法：使用 lsof</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo lsof -n -P -p 1333 | grep TCP</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>.local 域名疑问</title>
      <link href="/2021/01/25/local-%E5%9F%9F%E5%90%8D%E7%96%91%E9%97%AE/"/>
      <url>/2021/01/25/local-%E5%9F%9F%E5%90%8D%E7%96%91%E9%97%AE/</url>
      
        <content type="html"><![CDATA[<h2 id="起因"><a href="#起因" class="headerlink" title="起因"></a>起因</h2><pre><code>通过谷歌浏览器访问 `fed-static.local` 这个域名时，响应的时长总为 大于 `5s`</code></pre><h2 id="使用curl"><a href="#使用curl" class="headerlink" title="使用curl"></a>使用curl</h2><h3 id="情况1："><a href="#情况1：" class="headerlink" title="情况1："></a>情况1：</h3><ol><li><code>curl -vo /dev/null &#39;http://fed-static.local&#39;</code></li><li>结果输出<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">❯ curl -vo /dev/null <span class="string">&#x27;http://fed-static.local&#x27;</span></span><br><span class="line">  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current</span><br><span class="line">                                 Dload  Upload   Total   Spent    Left  Speed</span><br><span class="line">  0     0    0     0    0     0      0      0 --:--:--  0:00:04 --:--:--     0*   Trying 192.168.20.214...</span><br><span class="line">* TCP_NODELAY <span class="built_in">set</span></span><br><span class="line">* Connected to fed-static.local (192.168.20.214) port 80 (<span class="comment">#0)</span></span><br><span class="line">&gt; GET / HTTP/1.1</span><br><span class="line">&gt; Host: fed-static.local</span><br><span class="line">&gt; User-Agent: curl/7.64.1</span><br><span class="line">&gt; Accept: */*</span><br><span class="line">&gt;</span><br><span class="line">&lt; HTTP/1.1 200 OK</span><br><span class="line">&lt; Server: nginx/1.13.3</span><br><span class="line">&lt; Date: Mon, 25 Jan 2021 06:31:09 GMT</span><br><span class="line">&lt; Content-Type: text/html; charset=utf-8</span><br><span class="line">&lt; Content-Length: 3340</span><br><span class="line">&lt; Last-Modified: Sun, 03 Jan 2021 13:57:02 GMT</span><br><span class="line">&lt; Connection: keep-alive</span><br><span class="line">&lt; Vary: Accept-Encoding</span><br><span class="line">&lt; ETag: <span class="string">&quot;5ff1cd2e-d0c&quot;</span></span><br><span class="line">&lt; Accept-Ranges: bytes</span><br><span class="line">&lt;</span><br><span class="line">&#123; [3340 bytes data]</span><br><span class="line">100  3340  100  3340    0     0    650      0  0:00:05  0:00:05 --:--:--   783</span><br><span class="line">* Connection <span class="comment">#0 to host fed-static.local left intact</span></span><br><span class="line">* Closing connection 0</span><br></pre></td></tr></table></figure></li></ol><h3 id="情况2"><a href="#情况2" class="headerlink" title="情况2:"></a>情况2:</h3><ol><li><code>curl -vo /dev/null -H &#39;host:fed-static.local&#39; &#39;http://192.168.20.214&#39;</code></li><li>结果输出：<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">❯ curl -vo /dev/null -H <span class="string">&#x27;host:fed-static.local&#x27;</span> <span class="string">&#x27;http://192.168.20.214&#x27;</span></span><br><span class="line">  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current</span><br><span class="line">                                 Dload  Upload   Total   Spent    Left  Speed</span><br><span class="line">  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying 192.168.20.214...</span><br><span class="line">* TCP_NODELAY <span class="built_in">set</span></span><br><span class="line">* Connected to 192.168.20.214 (192.168.20.214) port 80 (<span class="comment">#0)</span></span><br><span class="line">&gt; GET / HTTP/1.1</span><br><span class="line">&gt; Host:fed-static.local</span><br><span class="line">&gt; User-Agent: curl/7.64.1</span><br><span class="line">&gt; Accept: */*</span><br><span class="line">&gt;</span><br><span class="line">&lt; HTTP/1.1 200 OK</span><br><span class="line">&lt; Server: nginx/1.13.3</span><br><span class="line">&lt; Date: Mon, 25 Jan 2021 06:33:18 GMT</span><br><span class="line">&lt; Content-Type: text/html; charset=utf-8</span><br><span class="line">&lt; Content-Length: 3340</span><br><span class="line">&lt; Last-Modified: Sun, 03 Jan 2021 13:57:02 GMT</span><br><span class="line">&lt; Connection: keep-alive</span><br><span class="line">&lt; Vary: Accept-Encoding</span><br><span class="line">&lt; ETag: <span class="string">&quot;5ff1cd2e-d0c&quot;</span></span><br><span class="line">&lt; Accept-Ranges: bytes</span><br><span class="line">&lt;</span><br><span class="line">&#123; [3340 bytes data]</span><br><span class="line">100  3340  100  3340    0     0   191k      0 --:--:-- --:--:-- --:--:--  191k</span><br><span class="line">* Connection <span class="comment">#0 to host 192.168.20.214 left intact</span></span><br><span class="line">* Closing connection 0</span><br></pre></td></tr></table></figure></li></ol><h2 id="使用浏览器"><a href="#使用浏览器" class="headerlink" title="使用浏览器"></a>使用浏览器</h2><ul><li>谷歌内核的浏览器，在dns lookup的时间要5秒</li><li>safari/firfox 正常响应，没有5的dns lookup</li></ul><h2 id="原因猜想："><a href="#原因猜想：" class="headerlink" title="原因猜想："></a>原因猜想：</h2><ol><li><a href="https://www.cnblogs.com/bonelee/p/7567029.html">为什么是 5 秒？ man resolv.conf 可以看到 glibc 的 resolver 的缺省超时时间是 5s</a></li><li><a href="https://www.bookstack.cn/read/kubernetes-practice-guide/troubleshooting-cases-dns-lookup-5s-delay.md">mDNS的域名与普通DNS的域名是通过后缀.local区分开来的</a></li><li><a href="https://en.wikipedia.org/wiki/.local">维基百科解说.local</a></li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> dns </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>msyql - show processlist</title>
      <link href="/2021/01/14/mysql-show%20processlist/"/>
      <url>/2021/01/14/mysql-show%20processlist/</url>
      
        <content type="html"><![CDATA[<h3 id="命令解说"><a href="#命令解说" class="headerlink" title="命令解说"></a>命令解说</h3><h4 id="1-作用"><a href="#1-作用" class="headerlink" title="1. 作用"></a>1. 作用</h4><pre><code>就是查看当前mysql正在执行的进程,主要有两个作用：</code></pre><ul><li>查看慢查询的sql是哪个</li><li>查看出现锁的sql是哪个</li></ul><h4 id="2-查看命令"><a href="#2-查看命令" class="headerlink" title="2. 查看命令"></a>2. 查看命令</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show processlist;</span><br></pre></td></tr></table></figure><h4 id="3-command字段"><a href="#3-command字段" class="headerlink" title="3. command字段"></a>3. command字段</h4><p>该字段的取值主要有：query和sleep两种结果。</p><p>（1）关注就是query命令。</p><p>（2）值为 sleep的理解</p><p>sleep是在等待prestatement（sql语句），它已经建立了connect，但是还没有开始执行，所以sleep状态多的话，那么数据库连接池就会被占用。所以：有时候sleep增多的原因可能是慢查询sql，但是sleep不是慢查询，因为它还没有开始执行。</p><h3 id="查看慢查询"><a href="#查看慢查询" class="headerlink" title="查看慢查询"></a>查看慢查询</h3><ol><li>慢查询，针对的是超过一定时间的查询。所以此时只需要关注两个因素：</li></ol><ul><li>command字段，值为query表示的是查询操作。</li><li>time字段，显示的查询时间。</li></ul><ol start="2"><li>从网上找到的kil慢查询的方法</li></ol><ul><li>第一步 查找出慢查询sql对应的进程id<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select id from prosslist where COMMAND = &#x27;query&#x27; and time &gt; 60*10</span><br></pre></td></tr></table></figure></li></ul><p>time字段的单位是秒，上面是查找10分钟慢查询sql</p><ul><li>第二步 kill掉查找到慢查询,在mysql客户端执行如下：<br><code>kill 3;</code></li></ul><blockquote><p>引用<br><a href="http://www.heartthinkdo.com/?p=434">Mysql show processlist命令解析</a></p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> mysql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用宏(Macro) 来扩展Laravel 的数据库请求构建器</title>
      <link href="/2021/01/05/%E4%BD%BF%E7%94%A8%E5%AE%8F-Macro-%E6%9D%A5%E6%89%A9%E5%B1%95Laravel-%E7%9A%84%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AF%B7%E6%B1%82%E6%9E%84%E5%BB%BA%E5%99%A8/"/>
      <url>/2021/01/05/%E4%BD%BF%E7%94%A8%E5%AE%8F-Macro-%E6%9D%A5%E6%89%A9%E5%B1%95Laravel-%E7%9A%84%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AF%B7%E6%B1%82%E6%9E%84%E5%BB%BA%E5%99%A8/</url>
      
        <content type="html"><![CDATA[<h3 id="定义宏"><a href="#定义宏" class="headerlink" title="定义宏"></a>定义宏</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Builder::macro(<span class="string">&#x27;searcher&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">Searcher <span class="variable">$searcher</span>, <span class="variable">$field</span> = <span class="literal">null</span></span>) </span>&#123;</span><br><span class="line">    <span class="comment">/** <span class="doctag">@var</span> Builder $this */</span></span><br><span class="line">    <span class="keyword">return</span> with(<span class="keyword">new</span> MacroSearcher(<span class="keyword">$this</span>, <span class="variable">$searcher</span>, <span class="variable">$field</span>))-&gt;execute();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="使用-Macro"><a href="#使用-Macro" class="headerlink" title="使用 Macro"></a>使用 Macro</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">User::query()</span><br><span class="line">    -&gt;select(<span class="string">&#x27;id&#x27;</span>, <span class="string">&#x27;name&#x27;</span>)</span><br><span class="line">    -&gt;searcher(<span class="keyword">new</span> EqualSearcher(<span class="number">1</span>), <span class="string">&#x27;id&#x27;</span>)</span><br><span class="line">    -&gt;toSql();</span><br><span class="line"></span><br><span class="line"><span class="comment">// select `id`, `name` from `user` where `id` = ?</span></span><br></pre></td></tr></table></figure><h3 id="完整代码"><a href="#完整代码" class="headerlink" title="完整代码"></a>完整代码</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1 Column </span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Column</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$name</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__constrct</span>(<span class="params"><span class="variable">$name</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;name = <span class="variable">$name</span>;        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2 Search</span></span><br><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Searcher</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@var</span> Request</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$request</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 查询字段名</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$searchKey</span> = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@var</span> Column</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$column</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">bind</span>(<span class="params">Column <span class="variable">$column</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;column = <span class="variable">$column</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;request = \request();</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">abstract</span> search(Builder <span class="variable">$builder</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3 MacroSearcher</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MacroSearcher</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@var</span> Builder</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$builder</span>;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@var</span> Searcher</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$searcher</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$field</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params">Builder <span class="variable">$builder</span>, Searcher <span class="variable">$searcher</span>, <span class="variable">$field</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">$this</span>-&gt;builder = <span class="variable">$builder</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;searcher = <span class="variable">$searcher</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;field = <span class="variable">$field</span>;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">wrapSearchers</span>(<span class="params">Searcher <span class="variable">$searcher</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$column</span> = <span class="variable">$searcher</span>-&gt;column();</span><br><span class="line">        <span class="variable">$args</span> = explode(<span class="string">&#x27;.&#x27;</span>, <span class="variable">$column</span>-&gt;getAlias());</span><br><span class="line">        <span class="keyword">if</span> (count(<span class="variable">$args</span>) &gt; <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="variable">$relation</span> = camel_case(<span class="variable">$args</span>[<span class="number">0</span>]);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">$this</span>-&gt;builder = <span class="keyword">$this</span>-&gt;builder-&gt;whereHas(<span class="variable">$relation</span>, <span class="function"><span class="keyword">function</span> (<span class="params"><span class="variable">$query</span></span>) <span class="keyword">use</span> (<span class="params"><span class="variable">$searcher</span></span>) </span>&#123;</span><br><span class="line">                <span class="variable">$searcher</span>-&gt;search(<span class="variable">$query</span>);</span><br><span class="line">            &#125;);</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;builder = <span class="variable">$searcher</span>-&gt;search(<span class="keyword">$this</span>-&gt;builder);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">execute</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">$this</span>-&gt;wrapSearchers(<span class="keyword">$this</span>-&gt;searcher-&gt;bind(<span class="keyword">new</span> Column(<span class="keyword">$this</span>-&gt;field)));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;builder;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ide-help"><a href="#ide-help" class="headerlink" title="ide-help"></a>ide-help</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># 在 _ide_helper 文件 底部，追加</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">Illuminate</span>\<span class="title">Database</span>\<span class="title">Query</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="title">use</span> <span class="title">Searcher</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Class Builder</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@package</span> Illuminate\Database\Query</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Builder</span></span></span><br><span class="line"><span class="class">    </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         *</span></span><br><span class="line"><span class="comment">         *</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@param</span> Searcher $searcher</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@param</span> string|null $field</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@return</span> $this</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">searcher</span>(<span class="params">Searcher <span class="variable">$searcher</span>, <span class="keyword">string</span> <span class="variable">$field</span> = <span class="literal">null</span></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">$this</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><blockquote><p>参考</p></blockquote><ul><li><p><a href="https://learnku.com/laravel/t/15247/expand-the-laravel-database-request-builder-using-macro-macro">使用宏（Macro）来扩展 Laravel 的数据库请求构建器</a></p></li><li><p><a href="https://github.com/spatie/laravel-collection-macros/issues/16">Autocomplete in IDE’s for custom macros?</a></p></li></ul>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>mark</title>
      <link href="/2020/12/22/%E5%89%8D%E7%AB%AF%E7%AC%94%E8%AE%B0/"/>
      <url>/2020/12/22/%E5%89%8D%E7%AB%AF%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<h3 id="如何阅读ECMAScript规范"><a href="#如何阅读ECMAScript规范" class="headerlink" title="如何阅读ECMAScript规范"></a>如何阅读ECMAScript规范</h3><p><a href="https://lisongfeng.cn/2020/09/08/understanding-ecmascript-part-1.html">part1</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>dns解析笔记</title>
      <link href="/2020/12/22/dns%E8%A7%A3%E6%9E%90%E7%AC%94%E8%AE%B0/"/>
      <url>/2020/12/22/dns%E8%A7%A3%E6%9E%90%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<h3 id="知识储备"><a href="#知识储备" class="headerlink" title="知识储备"></a>知识储备</h3><ul><li><a href="https://cloud.tencent.com/developer/article/1035350">MTR工具使用说明文档</a></li><li><a href="https://cloud.tencent.com/developer/article/1490848">客户端访问CDN网络异常排查流程</a></li><li><a href="https://ping.huatuo.qq.com/">华佗诊断分析系统</a></li><li><a href="http://debug.ping.dnsv1.com/ping.x?sid=XID-20201221-2018858982-rssp5i15afu9t5a13251jmcch0">测试出口IP和LDNS信息(海外)</a></li><li><a href="https://github.com/wall-wxk/ping-url">ping-url</a></li><li><a href="https://github.com/smartping/smartping">smartping</a></li><li><a href="https://www.cnblogs.com/hustskyking/p/hosts-modify.html">修改Hosts为何不生效，是DNS缓存？</a></li></ul>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>hexo 更换主题小记</title>
      <link href="/2018/03/26/hexo%E6%9B%B4%E6%8D%A2%E4%B8%BB%E9%A2%98%E5%B0%8F%E8%AE%B0/"/>
      <url>/2018/03/26/hexo%E6%9B%B4%E6%8D%A2%E4%B8%BB%E9%A2%98%E5%B0%8F%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<h3 id="目录划分"><a href="#目录划分" class="headerlink" title="目录划分"></a>目录划分</h3><ol><li><code>github</code> 上新增 <code>zhanghuid.github.io</code> 仓库</li><li>新开 <code>hexo</code> 分支，存放文章源码</li><li><code>master</code> 分支存放 <code>hexo d</code> 后产生的静态页面</li></ol><h3 id="备忘"><a href="#备忘" class="headerlink" title="备忘"></a>备忘</h3><ol><li><p>写作流程</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">1.1. git <span class="built_in">clone</span> git@github.com:zhanghuid/zhanghuid.github.io.git</span><br><span class="line">1.2. cnpm install</span><br><span class="line">1.3. hexo g // 编译生成静态页面</span><br><span class="line">1.4. hexo s // 开启服务器</span><br><span class="line">1.5. hexo new xxx // 新建写作模版</span><br><span class="line">1.6. git push origin hexo:hexo  // 推送原稿到hexo分支</span><br><span class="line">1.7. hexo d // 部署到github上</span><br></pre></td></tr></table></figure></li><li><p>细节注意</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">2.1. 由于主题是直接<span class="built_in">clone</span>下来</span><br><span class="line">git <span class="built_in">clone</span> https://github.com/tufu9441/maupassant-hexo.git themes/maupassant</span><br><span class="line">2.2. 所以切换hexo分支，push到github上时，maupassant主题不会跟着上去（这是别人家的仓库）</span><br><span class="line">2.3. 目前的做法是，记下主要的配置文件信息，到时直接覆盖</span><br></pre></td></tr></table></figure></li><li><p>主要参考</p><blockquote><p>3.1 <a href="https://www.haomwei.com/technology/maupassant-hexo.html">大道至简——Hexo简洁主题推荐</a> <br><br>3.2 <a href="https://www.zhihu.com/question/38781463">WARN No layout</a> <br><br>3.3 <a href="http://www.cnblogs.com/xinxiandong/p/3867505.html">hexo d报Permission denied</a> <br></p></blockquote></li><li><p>主要配置文件</p></li></ol><ul><li><p>根目录下 package.json</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;hexo-site&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;version&quot;</span>: <span class="string">&quot;0.0.0&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;private&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">&quot;hexo&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;version&quot;</span>: <span class="string">&quot;3.6.0&quot;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;dependencies&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;hexo&quot;</span>: <span class="string">&quot;^3.2.0&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;hexo-asset-image&quot;</span>: <span class="string">&quot;^0.0.3&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;hexo-deployer-git&quot;</span>: <span class="string">&quot;^0.3.0&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;hexo-generator-archive&quot;</span>: <span class="string">&quot;^0.1.4&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;hexo-generator-category&quot;</span>: <span class="string">&quot;^0.1.3&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;hexo-generator-feed&quot;</span>: <span class="string">&quot;^1.2.2&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;hexo-generator-index&quot;</span>: <span class="string">&quot;^0.2.0&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;hexo-generator-search&quot;</span>: <span class="string">&quot;^2.2.2&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;hexo-generator-tag&quot;</span>: <span class="string">&quot;^0.2.0&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;hexo-renderer-ejs&quot;</span>: <span class="string">&quot;^0.2.0&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;hexo-renderer-jade&quot;</span>: <span class="string">&quot;^0.4.1&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;hexo-renderer-marked&quot;</span>: <span class="string">&quot;^0.2.10&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;hexo-renderer-pug&quot;</span>: <span class="string">&quot;^0.0.5&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;hexo-renderer-sass&quot;</span>: <span class="string">&quot;^0.3.2&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;hexo-renderer-stylus&quot;</span>: <span class="string">&quot;^0.3.1&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;hexo-server&quot;</span>: <span class="string">&quot;^0.2.0&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>根目录下 _config.yml</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Hexo Configuration</span></span><br><span class="line"><span class="comment">## Docs: https://hexo.io/docs/configuration.html</span></span><br><span class="line"><span class="comment">## Source: https://github.com/hexojs/hexo/</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Site</span></span><br><span class="line"><span class="attr">title:</span> <span class="string">zhanghuid</span></span><br><span class="line"><span class="attr">subtitle:</span> <span class="string">huid</span> <span class="string">的</span> <span class="string">陋室</span></span><br><span class="line"><span class="attr">description:</span> <span class="string">write</span> <span class="string">down</span> <span class="string">something</span></span><br><span class="line"><span class="attr">author:</span> <span class="string">zhanghuid</span></span><br><span class="line"><span class="attr">language:</span> <span class="string">zh-CN</span></span><br><span class="line"><span class="attr">timezone:</span></span><br><span class="line"><span class="attr">avatar:</span> <span class="string">https://avatars2.githubusercontent.com/u/12711819?v=4&amp;u=966b0349b101f40e03926b472c47166c3c9da2ba&amp;s=400</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># URL</span></span><br><span class="line"><span class="comment">## If your site is put in a subdirectory, set url as &#x27;http://yoursite.com/child&#x27; and root as &#x27;/child/&#x27;</span></span><br><span class="line"><span class="attr">url:</span> <span class="string">http://writewrite.net</span></span><br><span class="line"><span class="attr">root:</span> <span class="string">/</span></span><br><span class="line"><span class="attr">permalink:</span> <span class="string">:year/:month/:day/:title/</span></span><br><span class="line"><span class="attr">permalink_defaults:</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Directory</span></span><br><span class="line"><span class="attr">source_dir:</span> <span class="string">source</span></span><br><span class="line"><span class="attr">public_dir:</span> <span class="string">public</span></span><br><span class="line"><span class="attr">tag_dir:</span> <span class="string">tags</span></span><br><span class="line"><span class="attr">archive_dir:</span> <span class="string">archives</span></span><br><span class="line"><span class="attr">category_dir:</span> <span class="string">categories</span></span><br><span class="line"><span class="attr">code_dir:</span> <span class="string">downloads/code</span></span><br><span class="line"><span class="attr">i18n_dir:</span> <span class="string">:lang</span></span><br><span class="line"><span class="attr">skip_render:</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Writing</span></span><br><span class="line"><span class="attr">new_post_name:</span> <span class="string">:title.md</span> <span class="comment"># File name of new posts</span></span><br><span class="line"><span class="attr">default_layout:</span> <span class="string">post</span></span><br><span class="line"><span class="attr">titlecase:</span> <span class="literal">false</span> <span class="comment"># Transform title into titlecase</span></span><br><span class="line"><span class="attr">external_link:</span> <span class="literal">true</span> <span class="comment"># Open external links in new tab</span></span><br><span class="line"><span class="attr">filename_case:</span> <span class="number">0</span></span><br><span class="line"><span class="attr">render_drafts:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">post_asset_folder:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">relative_link:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">future:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">highlight:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">line_number:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">auto_detect:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">tab_replace:</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Category &amp; Tag</span></span><br><span class="line"><span class="attr">default_category:</span> <span class="string">uncategorized</span></span><br><span class="line"><span class="attr">category_map:</span></span><br><span class="line"><span class="attr">tag_map:</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Date / Time format</span></span><br><span class="line"><span class="comment">## Hexo uses Moment.js to parse and display date</span></span><br><span class="line"><span class="comment">## You can customize the date format as defined in</span></span><br><span class="line"><span class="comment">## http://momentjs.com/docs/#/displaying/format/</span></span><br><span class="line"><span class="attr">date_format:</span> <span class="string">YYYY-MM-DD</span></span><br><span class="line"><span class="attr">time_format:</span> <span class="string">HH:mm:ss</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Pagination</span></span><br><span class="line"><span class="comment">## Set per_page to 0 to disable pagination</span></span><br><span class="line"><span class="attr">per_page:</span> <span class="number">10</span></span><br><span class="line"><span class="attr">pagination_dir:</span> <span class="string">page</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Extensions</span></span><br><span class="line"><span class="comment">## Plugins: https://hexo.io/plugins/</span></span><br><span class="line"><span class="comment">#RSS订阅</span></span><br><span class="line"><span class="attr">plugin:</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">hexo-generator-feed</span></span><br><span class="line"><span class="comment">#Feed Atom</span></span><br><span class="line"><span class="attr">feed:</span></span><br><span class="line"><span class="attr">type:</span> <span class="string">atom</span></span><br><span class="line"><span class="attr">path:</span> <span class="string">atom.xml</span></span><br><span class="line"><span class="attr">limit:</span> <span class="number">20</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## Themes: https://hexo.io/themes/</span></span><br><span class="line"><span class="attr">theme:</span> <span class="string">maupassant</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Deployment</span></span><br><span class="line"><span class="comment">## Docs: https://hexo.io/docs/deployment.html</span></span><br><span class="line"><span class="attr">deploy:</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">git</span></span><br><span class="line">  <span class="attr">repo:</span> <span class="string">git@github.com:/zhanghuid/zhanghuid.github.io.git</span></span><br><span class="line">  <span class="attr">branch:</span> <span class="string">master</span></span><br></pre></td></tr></table></figure></li><li><p>主题配置文件 <code>themes/maupassant/_config.yml</code></p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">fancybox:</span> <span class="literal">false</span> <span class="comment">## If you want to use fancybox please set the value to true.</span></span><br><span class="line"><span class="attr">disqus:</span> <span class="comment">## Your disqus_shortname, e.g. username</span></span><br><span class="line"><span class="attr">uyan:</span> <span class="comment">## Your uyan_id. e.g. 1234567</span></span><br><span class="line"><span class="attr">livere:</span> <span class="comment">## Your livere data-uid, e.g. MTAyMC8zMDAxOC78NTgz</span></span><br><span class="line"><span class="attr">changyan:</span> <span class="comment">## Your changyan appid, e.g. cyrALsXc8</span></span><br><span class="line"><span class="attr">changyan_conf:</span> <span class="comment">## Your changyan conf, e.g. prod_d8a508c2825ab57eeb43e7c69bba0e8b</span></span><br><span class="line"><span class="attr">gitment:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">false</span> <span class="comment">## If you want to use Gitment comment system please set the value to true.</span></span><br><span class="line">  <span class="attr">owner:</span> <span class="comment">## Your GitHub ID, e.g. username</span></span><br><span class="line">  <span class="attr">repo:</span> <span class="comment">## The repository to store your comments, make sure you&#x27;re the repo&#x27;s owner, e.g. imsun.github.io</span></span><br><span class="line">  <span class="attr">client_id:</span> <span class="comment">## GitHub client ID, e.g. 75752dafe7907a897619</span></span><br><span class="line">  <span class="attr">client_secret:</span> <span class="comment">## GitHub client secret, e.g. ec2fb9054972c891289640354993b662f4cccc50</span></span><br><span class="line"><span class="attr">gitalk:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">false</span> <span class="comment">## If you want to use Gitment comment system please set the value to true.</span></span><br><span class="line">  <span class="attr">owner:</span>  <span class="comment">## Your GitHub ID, e.g. username</span></span><br><span class="line">  <span class="attr">repo:</span>  <span class="comment">## The repository to store your comments, make sure you&#x27;re the repo&#x27;s owner, e.g. gitalk.github.io</span></span><br><span class="line">  <span class="attr">client_id:</span>  <span class="comment">## GitHub client ID, e.g. 75752dafe7907a897619</span></span><br><span class="line">  <span class="attr">client_secret:</span>  <span class="comment">## GitHub client secret, e.g. ec2fb9054972c891289640354993b662f4cccc50</span></span><br><span class="line">  <span class="attr">admin:</span>  <span class="comment">## Github repo owner and collaborators, only these guys can initialize github issues.</span></span><br><span class="line"><span class="attr">valine:</span> <span class="comment">## https://valine.js.org</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">false</span> <span class="comment">## If you want to use Valine comment system, please set the value to true.</span></span><br><span class="line">  <span class="attr">appid:</span> <span class="comment">## Your LeanCloud application App ID, e.g. pRBBL2JR4N7kLEGojrF0MsSs-gzGzoHsz</span></span><br><span class="line">  <span class="attr">appkey:</span> <span class="comment">## Your LeanCloud application App Key, e.g. tjczHpDfhjYDSYddzymYK1JJ</span></span><br><span class="line">  <span class="attr">notify:</span> <span class="literal">false</span> <span class="comment">## Mail notifier, see https://github.com/xCss/Valine/wiki/Valine-评论系统中的邮件提醒设置</span></span><br><span class="line">  <span class="attr">verify:</span> <span class="literal">false</span> <span class="comment">## Validation code.</span></span><br><span class="line">  <span class="attr">placeholder:</span> <span class="string">Just</span> <span class="string">so</span> <span class="string">so</span> <span class="comment">## Comment box placeholders.</span></span><br><span class="line">  <span class="attr">avatar:</span> <span class="string">&#x27;mm&#x27;</span> <span class="comment">## Gravatar type, see https://github.com/xCss/Valine/wiki/avatar-setting-for-valine</span></span><br><span class="line">  <span class="attr">pageSize:</span> <span class="number">10</span> <span class="comment">## Number of comments per page.</span></span><br><span class="line">  <span class="attr">guest_info:</span> <span class="string">nick,mail,link</span> <span class="comment">## Attributes of reviewers.</span></span><br><span class="line"></span><br><span class="line"><span class="attr">google_search:</span> <span class="literal">false</span> <span class="comment">## Use Google search, true/false.</span></span><br><span class="line"><span class="attr">baidu_search:</span> <span class="literal">false</span> <span class="comment">## Use Baidu search, true/false.</span></span><br><span class="line"><span class="attr">swiftype:</span> <span class="comment">## Your swiftype_key, e.g. m7b11ZrsT8Me7gzApciT</span></span><br><span class="line"><span class="attr">tinysou:</span> <span class="comment">## Your tinysou_key, e.g. 4ac092ad8d749fdc6293</span></span><br><span class="line"><span class="attr">self_search:</span> <span class="literal">true</span> <span class="comment">## Use a jQuery-based local search engine, true/false.</span></span><br><span class="line"><span class="attr">google_analytics:</span> <span class="comment">## Your Google Analytics tracking id, e.g. UA-42425684-2</span></span><br><span class="line"><span class="attr">baidu_analytics:</span> <span class="comment">## Your Baidu Analytics tracking id, e.g. 8006843039519956000</span></span><br><span class="line"><span class="attr">show_category_count:</span> <span class="literal">true</span> <span class="comment">## If you want to show the count of categories in the sidebar widget please set the value to true.</span></span><br><span class="line"><span class="attr">toc_number:</span> <span class="literal">true</span> <span class="comment">## If you want to add list number to toc please set the value to true.</span></span><br><span class="line"><span class="attr">shareto:</span> <span class="literal">false</span> <span class="comment">## If you want to use the share button please set the value to true, you must have hexo-helper-qrcode installed.</span></span><br><span class="line"><span class="attr">busuanzi:</span> <span class="literal">false</span> <span class="comment">## If you want to use Busuanzi page views please set the value to true.</span></span><br><span class="line"><span class="attr">widgets_on_small_screens:</span> <span class="literal">true</span> <span class="comment">## Set to true to enable widgets on small screens.</span></span><br><span class="line"><span class="attr">canvas_nest:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">false</span> <span class="comment">## If you want to use dynamic background please set the value to true, you can also fill the following parameters to customize the dynamic effect, or just leave them blank to keep the default effect.</span></span><br><span class="line">  <span class="attr">color:</span> <span class="comment">## RGB value of the color, e.g. &quot;100,99,98&quot;</span></span><br><span class="line">  <span class="attr">opacity:</span> <span class="comment">## Transparency of lines, e.g. &quot;0.7&quot;</span></span><br><span class="line">  <span class="attr">zIndex:</span> <span class="comment">## The z-index property of the background, e.g. &quot;-1&quot;</span></span><br><span class="line">  <span class="attr">count:</span> <span class="comment">## Quantity of lines, e.g. &quot;150&quot;</span></span><br><span class="line"><span class="attr">donate:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">false</span> <span class="comment">## If you want to show the donate button after each post, please set the value to true and fill the following items according to your need. You can also enable donate button in a page by adding a &quot;donate: true&quot; item to the front-matter.</span></span><br><span class="line">  <span class="attr">github:</span> <span class="comment">## GitHub URL, e.g. https://github.com/Kaiyuan/donate-page</span></span><br><span class="line">  <span class="attr">alipay_qr:</span> <span class="comment">## Path of Alipay QRcode image, e.g. /img/AliPayQR.png</span></span><br><span class="line">  <span class="attr">wechat_qr:</span> <span class="comment">## Path of Wechat QRcode image, e.g. /img/WeChatQR.png</span></span><br><span class="line">  <span class="attr">btc_qr:</span> <span class="comment">## Path of Bitcoin QRcode image, e.g. /img/BTCQR.png</span></span><br><span class="line">  <span class="attr">btc_key:</span> <span class="comment">## Bitcoin key, e.g. 1KuK5eK2BLsqpsFVXXSBG5wbSAwZVadt6L</span></span><br><span class="line">  <span class="attr">paypal_url:</span> <span class="comment">## Paypal URL, e.g. https://paypal.me/tufu9441</span></span><br><span class="line"></span><br><span class="line"><span class="attr">menu:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">page:</span> <span class="string">home</span></span><br><span class="line">    <span class="attr">directory:</span> <span class="string">.</span></span><br><span class="line">    <span class="attr">icon:</span> <span class="string">fa-home</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">page:</span> <span class="string">archive</span></span><br><span class="line">    <span class="attr">directory:</span> <span class="string">archives/</span></span><br><span class="line">    <span class="attr">icon:</span> <span class="string">fa-archive</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">page:</span> <span class="string">about</span></span><br><span class="line">    <span class="attr">directory:</span> <span class="string">about/</span></span><br><span class="line">    <span class="attr">icon:</span> <span class="string">fa-user</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">page:</span> <span class="string">rss</span></span><br><span class="line">    <span class="attr">directory:</span> <span class="string">atom.xml</span></span><br><span class="line">    <span class="attr">icon:</span> <span class="string">fa-rss</span></span><br><span class="line"></span><br><span class="line"><span class="attr">widgets:</span> <span class="comment">## Six widgets in sidebar provided: search, category, tag, recent_posts, rencent_comments and links.</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">search</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">category</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">tag</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">recent_posts</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">recent_comments</span></span><br><span class="line">  <span class="comment"># - links</span></span><br><span class="line"></span><br><span class="line"><span class="attr">links:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">title:</span> <span class="string">site-name1</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">http://www.example1.com/</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">title:</span> <span class="string">site-name2</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">http://www.example2.com/</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">title:</span> <span class="string">site-name3</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">http://www.example3.com/</span></span><br><span class="line"></span><br><span class="line"><span class="attr">timeline:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">num:</span> <span class="number">1</span></span><br><span class="line">    <span class="attr">word:</span> <span class="number">2014</span><span class="string">/06/12-Start</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">num:</span> <span class="number">2</span></span><br><span class="line">    <span class="attr">word:</span> <span class="number">2014</span><span class="string">/11/29-XXX</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">num:</span> <span class="number">3</span></span><br><span class="line">    <span class="attr">word:</span> <span class="number">2015</span><span class="string">/02/18-DDD</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">num:</span> <span class="number">4</span></span><br><span class="line">    <span class="attr">word:</span> <span class="string">More</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Static files</span></span><br><span class="line"><span class="attr">js:</span> <span class="string">js</span></span><br><span class="line"><span class="attr">css:</span> <span class="string">css</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Theme version</span></span><br><span class="line"><span class="attr">version:</span> <span class="number">0.0</span><span class="number">.0</span></span><br></pre></td></tr></table></figure></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>laravel-excel-tips</title>
      <link href="/2018/03/23/laravel-excel-tips/"/>
      <url>/2018/03/23/laravel-excel-tips/</url>
      
        <content type="html"><![CDATA[<h3 id="本文使用前提条件"><a href="#本文使用前提条件" class="headerlink" title="本文使用前提条件"></a>本文使用前提条件</h3><ol><li><code>&quot;maatwebsite/excel&quot;: &quot;~2.1.0&quot;</code></li><li><a href="https://laravel-excel.maatwebsite.nl/docs/2.1/getting-started/basics">laravel-excel手册，这个很重要</a></li></ol><h3 id="laravel-excel的简单操作"><a href="#laravel-excel的简单操作" class="headerlink" title="laravel-excel的简单操作"></a>laravel-excel的简单操作</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 主要代码</span></span><br><span class="line"> Excel::create(<span class="keyword">$this</span>-&gt;getTable(), <span class="function"><span class="keyword">function</span> (<span class="params"><span class="variable">$excel</span></span>) </span>&#123;</span><br><span class="line">    <span class="variable">$excel</span>-&gt;sheet(<span class="string">&#x27;Sheetname11&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params"><span class="variable">$sheet</span></span>) </span>&#123;</span><br><span class="line">        <span class="comment">// do something</span></span><br><span class="line">    &#125;</span><br><span class="line"> &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="单元格操作"><a href="#单元格操作" class="headerlink" title="单元格操作"></a>单元格操作</h4><ol><li>宽度<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$sheet</span>-&gt;setWidth(<span class="string">&#x27;A&#x27;</span>, <span class="number">5</span>);</span><br><span class="line"><span class="comment">// Set width for multiple cells</span></span><br><span class="line"><span class="variable">$sheet</span>-&gt;setWidth(<span class="keyword">array</span>(</span><br><span class="line">    <span class="string">&#x27;A&#x27;</span>     =&gt;  <span class="number">5</span>,</span><br><span class="line">    <span class="string">&#x27;B&#x27;</span>     =&gt;  <span class="number">10</span></span><br><span class="line">));</span><br></pre></td></tr></table></figure></li><li>高度<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$sheet</span>-&gt;setHeight(<span class="number">1</span>, <span class="number">50</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Set height for multiple rows</span></span><br><span class="line"><span class="variable">$sheet</span>-&gt;setHeight(<span class="keyword">array</span>(</span><br><span class="line">    <span class="number">1</span>     =&gt;  <span class="number">50</span>,</span><br><span class="line">    <span class="number">2</span>     =&gt;  <span class="number">25</span></span><br><span class="line">));</span><br></pre></td></tr></table></figure></li><li>宽高<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$sheet</span>-&gt;setSize(<span class="string">&#x27;A1&#x27;</span>, <span class="number">500</span>, <span class="number">50</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$sheet</span>-&gt;setSize(<span class="keyword">array</span>(</span><br><span class="line">    <span class="string">&#x27;A1&#x27;</span> =&gt; <span class="keyword">array</span>(</span><br><span class="line">        <span class="string">&#x27;width&#x27;</span>     =&gt; <span class="number">50</span>,</span><br><span class="line">        <span class="string">&#x27;height&#x27;</span>    =&gt; <span class="number">500</span></span><br><span class="line">    )</span><br><span class="line">));</span><br></pre></td></tr></table></figure></li><li>设置图片<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$objDrawing</span> = <span class="keyword">new</span> PHPExcel_Worksheet_Drawing();</span><br><span class="line"><span class="variable">$objDrawing</span>-&gt;setPath(<span class="string">&#x27;本地图片路径&#x27;</span>);</span><br><span class="line"><span class="comment"># 设置图片高度</span></span><br><span class="line"><span class="variable">$objDrawing</span>-&gt;setHeight(<span class="string">&#x27;xxx&#x27;</span>);</span><br><span class="line"><span class="comment"># 设置照片宽度</span></span><br><span class="line"><span class="variable">$objDrawing</span>-&gt;setWidth(<span class="string">&#x27;xxx&#x27;</span>);</span><br><span class="line"><span class="comment"># 设置图片要插入的单元格</span></span><br><span class="line"><span class="variable">$objDrawing</span>-&gt;setCoordinates(<span class="string">&#x27;xxx&#x27;</span>);</span><br><span class="line"><span class="variable">$objDrawing</span>-&gt;setWorksheet(<span class="variable">$sheet</span>);</span><br></pre></td></tr></table></figure></li></ol><h3 id="练手"><a href="#练手" class="headerlink" title="练手"></a>练手</h3><ol><li><p>新建用户表</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Schema::create(<span class="string">&#x27;users&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">Blueprint <span class="variable">$table</span></span>) </span>&#123;</span><br><span class="line">    <span class="variable">$table</span>-&gt;increments(<span class="string">&#x27;id&#x27;</span>);</span><br><span class="line">    <span class="variable">$table</span>-&gt;string(<span class="string">&#x27;name&#x27;</span>);</span><br><span class="line">    <span class="variable">$table</span>-&gt;string(<span class="string">&#x27;email&#x27;</span>)-&gt;unique();</span><br><span class="line">    <span class="variable">$table</span>-&gt;string(<span class="string">&#x27;password&#x27;</span>);</span><br><span class="line">    <span class="variable">$table</span>-&gt;string(<span class="string">&#x27;image&#x27;</span>, <span class="number">255</span>);</span><br><span class="line">    <span class="variable">$table</span>-&gt;rememberToken();</span><br><span class="line">    <span class="variable">$table</span>-&gt;timestamps();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li><p>生成用户数据</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义user的工厂</span></span><br><span class="line"><span class="variable">$factory</span>-&gt;define(App\User::class, <span class="function"><span class="keyword">function</span> (<span class="params">Faker <span class="variable">$faker</span></span>) </span>&#123;</span><br><span class="line">    <span class="variable">$path</span> = <span class="string">&#x27;app&#x27;</span> . DIRECTORY_SEPARATOR . <span class="string">&#x27;public&#x27;</span> . DIRECTORY_SEPARATOR  . <span class="string">&#x27;image&#x27;</span>;</span><br><span class="line">    <span class="keyword">return</span> [</span><br><span class="line">        <span class="string">&#x27;name&#x27;</span> =&gt; <span class="variable">$faker</span>-&gt;name,</span><br><span class="line">        <span class="string">&#x27;email&#x27;</span> =&gt; <span class="variable">$faker</span>-&gt;unique()-&gt;safeEmail,</span><br><span class="line">        <span class="string">&#x27;password&#x27;</span> =&gt; <span class="string">&#x27;$2y$10$TKh8H1.PfQx37YgCzwiKb.KjNyWgaHb9cbcoQgdIVFlYg7B77UdFm&#x27;</span>, <span class="comment">// secret</span></span><br><span class="line">        <span class="string">&#x27;remember_token&#x27;</span> =&gt; str_random(<span class="number">10</span>),</span><br><span class="line">        <span class="string">&#x27;image&#x27;</span> =&gt; <span class="variable">$path</span> . <span class="variable">$faker</span>-&gt;image(storage_path(<span class="variable">$path</span>), <span class="number">640</span>, <span class="number">480</span>, <span class="literal">null</span>, <span class="literal">false</span>)</span><br><span class="line">    ];</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><blockquote><p>注意<br></p></blockquote></li><li><ol><li>运行 php artisan tinker后报：<code>PHP Warning:  unlink ... Resource temporarily unavailable </code><br></li></ol></li><li><ol start="2"><li><a href="https://segmentfault.com/q/1010000002396283">原因</a><br></li></ol></li><li><ol start="3"><li><a href="https://github.com/fzaninotto/Faker/issues/1402">解决方案</a><br></li></ol></li><li><p>测试</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">testExcelExport</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$basePath</span> = storage_path(<span class="string">&#x27;excel&#x27;</span>. DIRECTORY_SEPARATOR .<span class="string">&#x27;exports&#x27;</span>);</span><br><span class="line">    <span class="variable">$fileName</span> = <span class="string">&#x27;exportFile&#x27;</span>;</span><br><span class="line">    <span class="variable">$ext</span> = <span class="string">&#x27;xls&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    \Excel::create(<span class="variable">$fileName</span>, <span class="function"><span class="keyword">function</span> (<span class="params"><span class="variable">$excel</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$excel</span>-&gt;sheet(<span class="string">&#x27;Sheetname11&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params"><span class="variable">$sheet</span></span>) </span>&#123;</span><br><span class="line">            <span class="variable">$rows</span> = User::all()-&gt;toArray();</span><br><span class="line">            array_unshift(<span class="variable">$rows</span>, [<span class="string">&#x27;name&#x27;</span> =&gt; <span class="string">&#x27;Name&#x27;</span>, <span class="string">&#x27;email&#x27;</span> =&gt; <span class="string">&#x27;Email&#x27;</span>, <span class="string">&#x27;image&#x27;</span> =&gt; <span class="string">&#x27;Image&#x27;</span>]);</span><br><span class="line">            <span class="comment">// 设置宽度</span></span><br><span class="line">            <span class="variable">$sheet</span>-&gt;setWidth(<span class="string">&#x27;A&#x27;</span>, <span class="number">30</span>);</span><br><span class="line">            <span class="variable">$sheet</span>-&gt;setWidth(<span class="string">&#x27;B&#x27;</span>, <span class="number">30</span>);</span><br><span class="line">            <span class="variable">$sheet</span>-&gt;setWidth(<span class="string">&#x27;C&#x27;</span>, <span class="number">30</span>);</span><br><span class="line">            <span class="comment">// 设置边框</span></span><br><span class="line">            <span class="variable">$sheet</span>-&gt;setBorder(<span class="string">&#x27;A1&#x27;</span>, <span class="string">&#x27;thin&#x27;</span>);</span><br><span class="line">            <span class="variable">$sheet</span>-&gt;setBorder(<span class="string">&#x27;B1&#x27;</span>, <span class="string">&#x27;thin&#x27;</span>);</span><br><span class="line">            <span class="variable">$sheet</span>-&gt;setBorder(<span class="string">&#x27;C1&#x27;</span>, <span class="string">&#x27;thin&#x27;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="variable">$num</span> = count(<span class="variable">$rows</span>);</span><br><span class="line">            <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$num</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line"></span><br><span class="line">                <span class="variable">$sheet</span>-&gt;cell(<span class="string">&#x27;A&#x27;</span> . (<span class="variable">$i</span> + <span class="number">1</span>), <span class="function"><span class="keyword">function</span> (<span class="params"><span class="variable">$cell</span></span>) <span class="keyword">use</span> (<span class="params"><span class="variable">$rows</span>, <span class="variable">$i</span></span>) </span>&#123;</span><br><span class="line">                    <span class="variable">$cell</span>-&gt;setValue(<span class="variable">$rows</span>[<span class="variable">$i</span>][<span class="string">&#x27;name&#x27;</span>]);</span><br><span class="line">                    <span class="variable">$cell</span>-&gt;setAlignment(<span class="string">&#x27;center&#x27;</span>);</span><br><span class="line">                    <span class="variable">$cell</span>-&gt;setValignment(<span class="string">&#x27;center&#x27;</span>);</span><br><span class="line">                &#125;);</span><br><span class="line">                <span class="variable">$sheet</span>-&gt;cell(<span class="string">&#x27;B&#x27;</span> . (<span class="variable">$i</span> + <span class="number">1</span>), <span class="function"><span class="keyword">function</span> (<span class="params"><span class="variable">$cell</span></span>) <span class="keyword">use</span> (<span class="params"><span class="variable">$rows</span>, <span class="variable">$i</span></span>) </span>&#123;</span><br><span class="line">                    <span class="variable">$cell</span>-&gt;setValue(<span class="variable">$rows</span>[<span class="variable">$i</span>][<span class="string">&#x27;email&#x27;</span>]);</span><br><span class="line">                    <span class="variable">$cell</span>-&gt;setAlignment(<span class="string">&#x27;center&#x27;</span>);</span><br><span class="line">                    <span class="variable">$cell</span>-&gt;setValignment(<span class="string">&#x27;center&#x27;</span>);</span><br><span class="line">                &#125;);</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> ((<span class="variable">$i</span> + <span class="number">1</span>) == <span class="number">1</span>) &#123; <span class="comment">// 过滤第一组数据，因为第一组没有图片路径</span></span><br><span class="line">                    <span class="variable">$sheet</span>-&gt;setCellValue(<span class="string">&#x27;C1&#x27;</span>, <span class="variable">$rows</span>[<span class="variable">$i</span>][<span class="string">&#x27;image&#x27;</span>]);</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// 设置行高</span></span><br><span class="line">                <span class="variable">$sheet</span>-&gt;setHeight((<span class="variable">$i</span> + <span class="number">1</span>), <span class="number">105</span>);</span><br><span class="line">                <span class="comment">// 设置图片存储</span></span><br><span class="line">                <span class="variable">$objDrawing</span> = <span class="keyword">new</span> PHPExcel_Worksheet_Drawing();</span><br><span class="line">                <span class="variable">$objDrawing</span>-&gt;setPath(storage_path(<span class="string">&#x27;/&#x27;</span> . <span class="variable">$rows</span>[<span class="variable">$i</span>][<span class="string">&#x27;image&#x27;</span>]));</span><br><span class="line">                <span class="comment"># 设置图片高度</span></span><br><span class="line">                <span class="variable">$objDrawing</span>-&gt;setHeight(<span class="number">190</span>);</span><br><span class="line">                <span class="comment"># 设置照片宽度</span></span><br><span class="line">                <span class="variable">$objDrawing</span>-&gt;setWidth(<span class="number">190</span>);</span><br><span class="line">                <span class="comment"># 设置图片要插入的单元格</span></span><br><span class="line">                <span class="variable">$objDrawing</span>-&gt;setCoordinates(<span class="string">&#x27;C&#x27;</span> . (<span class="variable">$i</span> + <span class="number">1</span>));</span><br><span class="line">                <span class="variable">$objDrawing</span>-&gt;setWorksheet(<span class="variable">$sheet</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">    &#125;)-&gt;store(<span class="variable">$ext</span>, <span class="variable">$basePath</span>);</span><br><span class="line"></span><br><span class="line">    <span class="variable">$filePath</span> = <span class="variable">$basePath</span> . DIRECTORY_SEPARATOR . <span class="variable">$fileName</span> . <span class="string">&#x27;.&#x27;</span> . <span class="variable">$ext</span>;</span><br><span class="line">    <span class="keyword">$this</span>-&gt;assertTrue(file_exists(<span class="variable">$filePath</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> laravel </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>初探laradoc</title>
      <link href="/2017/08/29/%E5%88%9D%E6%8E%A2laradock/"/>
      <url>/2017/08/29/%E5%88%9D%E6%8E%A2laradock/</url>
      
        <content type="html"><![CDATA[<h2 id="前提："><a href="#前提：" class="headerlink" title="前提："></a>前提：</h2><h3 id="docker-version"><a href="#docker-version" class="headerlink" title="docker version"></a>docker version</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">Client:</span><br><span class="line"> Version:      17.06.1-ce</span><br><span class="line"> API version:  1.30</span><br><span class="line"> Go version:   go1.8.3</span><br><span class="line"> Git commit:   874a737</span><br><span class="line"> Built:        Thu Aug 17 22:48:20 2017</span><br><span class="line"> OS/Arch:      windows/amd64</span><br><span class="line"></span><br><span class="line">Server:</span><br><span class="line"> Version:      17.06.1-ce</span><br><span class="line"> API version:  1.30 (minimum version 1.12)</span><br><span class="line"> Go version:   go1.8.3</span><br><span class="line"> Git commit:   874a737</span><br><span class="line"> Built:        Thu Aug 17 22:54:55 2017</span><br><span class="line"> OS/Arch:      linux/amd64</span><br><span class="line"> Experimental: true</span><br></pre></td></tr></table></figure><h2 id="laradoc"><a href="#laradoc" class="headerlink" title="laradoc"></a>laradoc</h2><p>这里记录一下个人所选择的安装<strong>流程</strong>及遇到的<strong>坑</strong>和简单<strong>使用</strong></p><blockquote><p><strong>具体可参考：</strong></p><p><a href="'http://laradock.io'">英文</a></p><p><a href="'https://github.com/laradock/laradock/blob/v5.5.0/README-zh.md'">中文:v5.0.0</a></p></blockquote><h3 id="安装流程："><a href="#安装流程：" class="headerlink" title="安装流程："></a>安装流程：</h3><h4 id="依赖："><a href="#依赖：" class="headerlink" title="依赖："></a>依赖：</h4><ul><li><a href="https://git-scm.com/downloads">Git</a></li><li><a href="https://www.docker.com/products/docker/">Docker</a><h4 id="安装："><a href="#安装：" class="headerlink" title="安装："></a>安装：</h4></li><li> 克隆 Laradock 仓库:将laradock.git克隆到跟你的项目平级的目录下<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/laradock/laradock.git</span><br></pre></td></tr></table></figure></li></ul><p><img src="/2017/08/29/%E5%88%9D%E6%8E%A2laradock/%E7%9B%AE%E5%BD%95%E5%88%92%E5%88%86.png" alt="目录划分"></p><ul><li>编辑laradock目录下的.env 文件（如果没有.env，请复制.env.example）</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp .env.example .env</span><br></pre></td></tr></table></figure><ul><li>修改.env文件（这个很重要，基本上nginx跟mysql及php的配置都在里面可以配置）<br>由于，我需要配置多项目，所以，做如下修改：<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">APPLICATION_1=../  这一行代表nginx的www目录的位置，../：指的是laradock仓库的上一级目录</span><br></pre></td></tr></table></figure></li></ul><h3 id="使用："><a href="#使用：" class="headerlink" title="使用："></a>使用：</h3><h4 id="运行nginx跟mysql的服务"><a href="#运行nginx跟mysql的服务" class="headerlink" title="运行nginx跟mysql的服务"></a>运行nginx跟mysql的服务</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose up -d nginx mysql</span><br></pre></td></tr></table></figure><h4 id="maybe可以打开浏览器访问localhost，如果不行请往下看。"><a href="#maybe可以打开浏览器访问localhost，如果不行请往下看。" class="headerlink" title="maybe可以打开浏览器访问localhost，如果不行请往下看。"></a>maybe可以打开浏览器访问localhost，如果不行请往下看。</h4><h4 id="自定义虚拟域名"><a href="#自定义虚拟域名" class="headerlink" title="自定义虚拟域名"></a>自定义虚拟域名</h4><ul><li><p>进入laradock/nginx/sites</p></li><li><p>复制一份<code>sample.conf.example</code>重命名为<code>your like.conf</code></p></li><li><p>修改</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">server_name your like;</span><br><span class="line">root /var/www/your like;</span><br></pre></td></tr></table></figure></li><li><p> 重启nginx服务<br><code>docker-compose restart nginx</code></p></li></ul><h4 id="配置laraval项目连接数据库"><a href="#配置laraval项目连接数据库" class="headerlink" title="配置laraval项目连接数据库"></a>配置laraval项目连接数据库</h4><p>打开laravel项目的.env文件，修改<code>DB_HOST=XXX</code>为<code>DB_HOST=mysql</code></p><h3 id="常用的docker-compose命令"><a href="#常用的docker-compose命令" class="headerlink" title="常用的docker-compose命令"></a>常用的docker-compose命令</h3><p><code>docker-compose up -d nginx</code>：Create and start containers</p><p><code>docker-compose down</code> ：Stop and remove containers, networks, images, and volumes</p><p><code>docker-compose images</code>: List images</p><p><code>docker-compose exec</code>:  Execute a command in a running container</p><h3 id="some坑（一下的-env文件是v5-5-5）："><a href="#some坑（一下的-env文件是v5-5-5）：" class="headerlink" title="some坑（一下的.env文件是v5.5.5）："></a>some坑（一下的.env文件是v5.5.5）：</h3><ul><li>clone下的laradock后，必须<code>copy .env.example</code>并重命名为 <code>.env</code>。</li><li>有可能laradock有些版本使用起来有bug。比如，个人使用过的v5.5.5，mysql启动不了<ul><li>解决方案(个人)</li></ul><ol><li>切换版本，进入laradock。使用<code>git tag</code>列出所有的tag</li><li>使用<code>git checkout v5.0.0</code>，切换版本</li><li>查看当前分支版本：<code>git branch</code></li></ol></li><li>mysql,php,nginx的配置信息都在laradock/.env文件里<ul><li>切换php版本，可以改PHP_VERSION=70。</li><li>新增php扩展，可以改PHP_FPM_INSTALL_BCMATH=true（开启bc函数扩展）</li></ul></li><li>docker-compose命令得进去laradock才能执行 </li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> laradock </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Mutate, Linux平台上的Alfred</title>
      <link href="/2017/06/02/Mutate-Linux%E5%B9%B3%E5%8F%B0%E4%B8%8A%E7%9A%84Alfred/"/>
      <url>/2017/06/02/Mutate-Linux%E5%B9%B3%E5%8F%B0%E4%B8%8A%E7%9A%84Alfred/</url>
      
        <content type="html"><![CDATA[<h2 id="Mutate-Linux平台上的Alfred"><a href="#Mutate-Linux平台上的Alfred" class="headerlink" title="Mutate, Linux平台上的Alfred"></a>Mutate, Linux平台上的Alfred</h2><pre><code>Mutate 是一个受 Alfred 启发而设计的应用启动器，通过快捷键组合可以方便您快速执行常见任务</code></pre><blockquote><p>图片如下:<br><img src="/2017/06/02/Mutate-Linux%E5%B9%B3%E5%8F%B0%E4%B8%8A%E7%9A%84Alfred/mutate.png" alt="mutate"></p></blockquote><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><h4 id="编译安装"><a href="#编译安装" class="headerlink" title="编译安装"></a>编译安装</h4><ol><li><p>安装依赖</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install build-essential qt5-qmake qt5-default libgtk2.0-dev libqt5x11extras5-dev libboost-regex-dev</span><br></pre></td></tr></table></figure></li><li><p>下载并编译</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/qdore/Mutate.git</span><br><span class="line">cd Mutate/src</span><br><span class="line">qmake</span><br><span class="line">make</span><br></pre></td></tr></table></figure></li><li><p>安装</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">sudo make install</span><br><span class="line">cd ..</span><br><span class="line">sudo cp info/mutate.png /usr/share/icons</span><br><span class="line">sudo cp info/Mutate.desktop /usr/share/applications</span><br><span class="line">mkdir -p ~/.config/Mutate</span><br><span class="line">cp -R config/* ~/.config/Mutate</span><br><span class="line">chmod -R a+x ~/.config/Mutate/scripts</span><br><span class="line">chmod -R a+w ~/.config/Mutate</span><br><span class="line">sed -i &quot;s|&#123;home&#125;|$HOME|g&quot; ~/.config/Mutate/config.ini</span><br></pre></td></tr></table></figure></li><li><p>快捷键</p><blockquote><p>默认吊起快捷键 Ctrl + d</p></blockquote></li><li><p>功能</p></li></ol><ul><li>Find Applications &amp; Files</li></ul><p><img src="/2017/06/02/Mutate-Linux%E5%B9%B3%E5%8F%B0%E4%B8%8A%E7%9A%84Alfred/find_applications&files.png" alt="以关键字搜索应用程序，按类别搜索文件"></p><ul><li>Find Files</li></ul><p><img src="/2017/06/02/Mutate-Linux%E5%B9%B3%E5%8F%B0%E4%B8%8A%E7%9A%84Alfred/find_files.png" alt="查找文件"></p><ul><li>Calculate(thanks t413)<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">NOTE:You must install sympy first:</span><br><span class="line">sudo apt-get install python-pip</span><br><span class="line">sudo pip install sympy</span><br></pre></td></tr></table></figure></li></ul><p><img src="/2017/06/02/Mutate-Linux%E5%B9%B3%E5%8F%B0%E4%B8%8A%E7%9A%84Alfred/calc.png" alt="Calculate"></p><ul><li>Kill Processes</li></ul><p><img src="/2017/06/02/Mutate-Linux%E5%B9%B3%E5%8F%B0%E4%B8%8A%E7%9A%84Alfred/kill_pocesses.png" alt="kill_pocesses"></p><ul><li>Google Translate<br>Select some words use your mouse, then press Ctrl+T (user configurable): </li></ul><p><img src="/2017/06/02/Mutate-Linux%E5%B9%B3%E5%8F%B0%E4%B8%8A%E7%9A%84Alfred/Google_Translate.jpg" alt="Google_Translate"></p><p>Or type ‘tr’ and some words: </p><p><img src="/2017/06/02/Mutate-Linux%E5%B9%B3%E5%8F%B0%E4%B8%8A%E7%9A%84Alfred/tr.png" alt="tr"></p><ul><li>Quickly Search the Web</li></ul><p>Google Search</p><p><img src="/2017/06/02/Mutate-Linux%E5%B9%B3%E5%8F%B0%E4%B8%8A%E7%9A%84Alfred/Google_Search.png" alt="Google Search"></p><h4 id="更多详情请看"><a href="#更多详情请看" class="headerlink" title="更多详情请看:"></a>更多详情请看:</h4><p><a href="https://github.com/qdore/Mutate">网址</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> ubuntu </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
